{
  "training_history": {
    "train_loss": [
      1.1189658479195208,
      1.0816684497273676,
      1.0641788593302035,
      1.0533761444021033,
      1.0460419381318027,
      1.0408892394745186,
      1.0363419866316939,
      1.0335546479513655,
      1.0305829749668025,
      1.0282561227883378,
      1.0268853892610497,
      1.0247814561406228,
      1.0237166352195828,
      1.0240150714573795,
      1.0231700150389649,
      1.022677103066009,
      1.0218895654700118,
      1.021732718024624,
      1.0222376267251359,
      1.0221386672971455
    ],
    "train_accuracy": [
      0.4216553692472351,
      0.41933642525865145,
      0.4286122012129861,
      0.425365679628969,
      0.44673564038530145,
      0.4322868355333571,
      0.444987513378523,
      0.4356403853014627,
      0.4426328933285765,
      0.43182304673564037,
      0.43842311808776313,
      0.4403496254013557,
      0.44951837317160187,
      0.4459864430966821,
      0.446414555833036,
      0.44991080984659293,
      0.44798430253300037,
      0.44880485194434533,
      0.4476275419193721,
      0.4489118801284338
    ],
    "val_loss": [
      0.6692233730446209,
      0.6622499677267941,
      0.658925817229531,
      0.6425673939964988,
      0.6590306840159676,
      0.6454411154443568,
      0.6515050400387157,
      0.6499749091538516,
      0.6510882702740756,
      0.6453014991500161,
      0.6417196766896681,
      0.6410918279127641,
      0.6419849504124034,
      0.6419722177765587,
      0.6414753989739852,
      0.6408495052294297,
      0.6407322059978139,
      0.6408032205971804,
      0.6407457221638072,
      0.6405932307243347
    ],
    "val_accuracy": [
      0.4053938356164384,
      0.4096746575342466,
      0.40625,
      0.4295091324200913,
      0.4089611872146119,
      0.4267979452054795,
      0.3891267123287671,
      0.394263698630137,
      0.3946917808219178,
      0.4018264840182648,
      0.4069634703196347,
      0.4096746575342466,
      0.4092465753424658,
      0.4091038812785388,
      0.4093892694063927,
      0.4098173515981735,
      0.4098173515981735,
      0.4098173515981735,
      0.4098173515981735,
      0.4098173515981735
    ],
    "val_f1": [
      0.3174447174447175,
      0.31811438931926816,
      0.321760391198044,
      0.3228319783197832,
      0.32098360655737707,
      0.323167649536647,
      0.3274155538098979,
      0.32779097387173395,
      0.3277337559429477,
      0.3271268057784912,
      0.32598118715536817,
      0.3269887750122011,
      0.3266102797657775,
      0.32633805108182856,
      0.3262249715122904,
      0.32616487455197135,
      0.32616487455197135,
      0.32616487455197135,
      0.3259452411994785,
      0.3259452411994785
    ],
    "val_auroc": [
      0.5995762661824837,
      0.6060863853091832,
      0.6090924523567011,
      0.6120485511418154,
      0.6109099833193097,
      0.6130492449404367,
      0.6150701179457656,
      0.6158084968188595,
      0.6158766219387981,
      0.6166980352213512,
      0.6176317110254934,
      0.6174549399938001,
      0.6176430775135439,
      0.6177706921748373,
      0.617973222325554,
      0.6179053924390712,
      0.6179239183384262,
      0.6180160311766529,
      0.6179732961339179,
      0.6179386062028549
    ],
    "learning_rate": [
      0.000992403876506103,
      0.0009698463103929538,
      0.0009330127018922194,
      0.0008830222215594889,
      0.0008213938048432717,
      0.0007500000000000018,
      0.0006710100716628345,
      0.0005868240888334639,
      0.0004999999999999986,
      0.00041317591116653323,
      0.0003289899283371649,
      0.0002499999999999986,
      0.0001786061951567293,
      0.00011697777844051034,
      6.698729810778051e-05,
      3.0153689607045717e-05,
      7.596123493895977e-06,
      0.0,
      7.596123493895969e-06,
      3.015368960704586e-05
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.0.hook_resid_pre",
      "hook_layer": 0,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.01,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples",
      "probe_name": "ntml_binary_4T1L_500samples_layer_0",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority"
    },
    "training_history": {
      "train_loss": [
        1.1189658479195208,
        1.0816684497273676,
        1.0641788593302035,
        1.0533761444021033,
        1.0460419381318027,
        1.0408892394745186,
        1.0363419866316939,
        1.0335546479513655,
        1.0305829749668025,
        1.0282561227883378,
        1.0268853892610497,
        1.0247814561406228,
        1.0237166352195828,
        1.0240150714573795,
        1.0231700150389649,
        1.022677103066009,
        1.0218895654700118,
        1.021732718024624,
        1.0222376267251359,
        1.0221386672971455
      ],
      "train_accuracy": [
        0.4216553692472351,
        0.41933642525865145,
        0.4286122012129861,
        0.425365679628969,
        0.44673564038530145,
        0.4322868355333571,
        0.444987513378523,
        0.4356403853014627,
        0.4426328933285765,
        0.43182304673564037,
        0.43842311808776313,
        0.4403496254013557,
        0.44951837317160187,
        0.4459864430966821,
        0.446414555833036,
        0.44991080984659293,
        0.44798430253300037,
        0.44880485194434533,
        0.4476275419193721,
        0.4489118801284338
      ],
      "val_loss": [
        0.6692233730446209,
        0.6622499677267941,
        0.658925817229531,
        0.6425673939964988,
        0.6590306840159676,
        0.6454411154443568,
        0.6515050400387157,
        0.6499749091538516,
        0.6510882702740756,
        0.6453014991500161,
        0.6417196766896681,
        0.6410918279127641,
        0.6419849504124034,
        0.6419722177765587,
        0.6414753989739852,
        0.6408495052294297,
        0.6407322059978139,
        0.6408032205971804,
        0.6407457221638072,
        0.6405932307243347
      ],
      "val_accuracy": [
        0.4053938356164384,
        0.4096746575342466,
        0.40625,
        0.4295091324200913,
        0.4089611872146119,
        0.4267979452054795,
        0.3891267123287671,
        0.394263698630137,
        0.3946917808219178,
        0.4018264840182648,
        0.4069634703196347,
        0.4096746575342466,
        0.4092465753424658,
        0.4091038812785388,
        0.4093892694063927,
        0.4098173515981735,
        0.4098173515981735,
        0.4098173515981735,
        0.4098173515981735,
        0.4098173515981735
      ],
      "val_f1": [
        0.3174447174447175,
        0.31811438931926816,
        0.321760391198044,
        0.3228319783197832,
        0.32098360655737707,
        0.323167649536647,
        0.3274155538098979,
        0.32779097387173395,
        0.3277337559429477,
        0.3271268057784912,
        0.32598118715536817,
        0.3269887750122011,
        0.3266102797657775,
        0.32633805108182856,
        0.3262249715122904,
        0.32616487455197135,
        0.32616487455197135,
        0.32616487455197135,
        0.3259452411994785,
        0.3259452411994785
      ],
      "val_auroc": [
        0.5995762661824837,
        0.6060863853091832,
        0.6090924523567011,
        0.6120485511418154,
        0.6109099833193097,
        0.6130492449404367,
        0.6150701179457656,
        0.6158084968188595,
        0.6158766219387981,
        0.6166980352213512,
        0.6176317110254934,
        0.6174549399938001,
        0.6176430775135439,
        0.6177706921748373,
        0.617973222325554,
        0.6179053924390712,
        0.6179239183384262,
        0.6180160311766529,
        0.6179732961339179,
        0.6179386062028549
      ],
      "learning_rate": [
        0.000992403876506103,
        0.0009698463103929538,
        0.0009330127018922194,
        0.0008830222215594889,
        0.0008213938048432717,
        0.0007500000000000018,
        0.0006710100716628345,
        0.0005868240888334639,
        0.0004999999999999986,
        0.00041317591116653323,
        0.0003289899283371649,
        0.0002499999999999986,
        0.0001786061951567293,
        0.00011697777844051034,
        6.698729810778051e-05,
        3.0153689607045717e-05,
        7.596123493895977e-06,
        0.0,
        7.596123493895969e-06,
        3.015368960704586e-05
      ]
    },
    "final_metrics": {
      "loss": 0.6405932307243347,
      "accuracy": 0.4098173515981735,
      "precision": 0.2008838891120932,
      "recall": 0.8635578583765112,
      "f1": 0.3259452411994785,
      "auroc": 0.6179386062028549
    },
    "best_val_f1": 0.32779097387173395,
    "training_time": 201.9352514743805,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.0.hook_resid_pre",
    "hook_layer": 0,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.01,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples",
    "probe_name": "ntml_binary_4T1L_500samples_layer_0",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority"
  }
}