{
  "training_history": {
    "train_loss": [
      1.0845212317901114,
      1.0426810378353346,
      1.0294853092328597,
      1.0213002547553685,
      1.0151022168803432,
      1.0097930156476966,
      1.0057894233699258,
      1.0023131818940105,
      0.99945581068187,
      0.9975382033820566,
      0.9960490447473308,
      0.993251980439713,
      0.9917817084484448,
      0.9915898457237574,
      0.9901976380582269,
      0.9902127117054648,
      0.9890958530717788,
      0.9898212554111873,
      0.9899176506146993,
      0.9906000001653689
    ],
    "train_accuracy": [
      0.40146271851587584,
      0.3925793792365323,
      0.41812343917231537,
      0.4301462718515876,
      0.4487334998216197,
      0.4596146985372815,
      0.4618622904031395,
      0.47898679985729575,
      0.48230467356403856,
      0.48622904031394937,
      0.49054584373885124,
      0.4899393506956832,
      0.49122368890474494,
      0.49721726721369963,
      0.5002497324295397,
      0.49960756332500894,
      0.5017838030681413,
      0.5000713521227257,
      0.49843025330003565,
      0.5001783803068142
    ],
    "val_loss": [
      0.6537109792232514,
      0.6545500549403104,
      0.6583523051305251,
      0.6527980045838789,
      0.6502360154281963,
      0.6472340188243172,
      0.6348920860073783,
      0.6398502447388389,
      0.6422106325626373,
      0.637419074231928,
      0.644311558116566,
      0.6406688104976307,
      0.6349317361008037,
      0.6378275242718783,
      0.6377015005458485,
      0.6376461668448015,
      0.6377138446677815,
      0.6377376128326763,
      0.6377811404791746,
      0.6376963209022175
    ],
    "val_accuracy": [
      0.3617294520547945,
      0.3690068493150685,
      0.3771404109589041,
      0.3971175799086758,
      0.4092465753424658,
      0.4195205479452055,
      0.4484874429223744,
      0.4402111872146119,
      0.4360730593607306,
      0.4479166666666667,
      0.4345034246575342,
      0.4444920091324201,
      0.4540525114155251,
      0.4486301369863014,
      0.4492009132420091,
      0.4492009132420091,
      0.4490582191780822,
      0.4492009132420091,
      0.4490582191780822,
      0.4493436073059361
    ],
    "val_f1": [
      0.3292847503373819,
      0.327350167325829,
      0.32524346885144534,
      0.32561851556264965,
      0.32463295269168024,
      0.3253731343283582,
      0.32630294579048286,
      0.3249010497332645,
      0.32490604714724974,
      0.32513518227803945,
      0.32314261315115284,
      0.3237797463956922,
      0.3259337561663143,
      0.32447552447552447,
      0.3242296918767507,
      0.3239929947460595,
      0.32417293891125504,
      0.3242296918767507,
      0.32417293891125504,
      0.3242864647172124
    ],
    "val_auroc": [
      0.6082998573297655,
      0.6097760157675082,
      0.6135301495882434,
      0.6143364957472874,
      0.6164296499867411,
      0.6144218202910239,
      0.6166192194995803,
      0.6176999483523524,
      0.6181720093126479,
      0.6186000930680383,
      0.6186534209078736,
      0.6189332094374205,
      0.619076464086622,
      0.6191351247104409,
      0.6193057007460785,
      0.6192796942926793,
      0.6193105952190496,
      0.6193035822428521,
      0.6193403273160537,
      0.6192975189405148
    ],
    "learning_rate": [
      0.000992403876506103,
      0.0009698463103929538,
      0.0009330127018922194,
      0.0008830222215594889,
      0.0008213938048432717,
      0.0007500000000000018,
      0.0006710100716628345,
      0.0005868240888334639,
      0.0004999999999999986,
      0.00041317591116653323,
      0.0003289899283371649,
      0.0002499999999999986,
      0.0001786061951567293,
      0.00011697777844051034,
      6.698729810778051e-05,
      3.0153689607045717e-05,
      7.596123493895977e-06,
      0.0,
      7.596123493895969e-06,
      3.015368960704586e-05
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.1.hook_resid_pre",
      "hook_layer": 1,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.01,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples",
      "probe_name": "ntml_binary_4T1L_500samples_layer_1",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority"
    },
    "training_history": {
      "train_loss": [
        1.0845212317901114,
        1.0426810378353346,
        1.0294853092328597,
        1.0213002547553685,
        1.0151022168803432,
        1.0097930156476966,
        1.0057894233699258,
        1.0023131818940105,
        0.99945581068187,
        0.9975382033820566,
        0.9960490447473308,
        0.993251980439713,
        0.9917817084484448,
        0.9915898457237574,
        0.9901976380582269,
        0.9902127117054648,
        0.9890958530717788,
        0.9898212554111873,
        0.9899176506146993,
        0.9906000001653689
      ],
      "train_accuracy": [
        0.40146271851587584,
        0.3925793792365323,
        0.41812343917231537,
        0.4301462718515876,
        0.4487334998216197,
        0.4596146985372815,
        0.4618622904031395,
        0.47898679985729575,
        0.48230467356403856,
        0.48622904031394937,
        0.49054584373885124,
        0.4899393506956832,
        0.49122368890474494,
        0.49721726721369963,
        0.5002497324295397,
        0.49960756332500894,
        0.5017838030681413,
        0.5000713521227257,
        0.49843025330003565,
        0.5001783803068142
      ],
      "val_loss": [
        0.6537109792232514,
        0.6545500549403104,
        0.6583523051305251,
        0.6527980045838789,
        0.6502360154281963,
        0.6472340188243172,
        0.6348920860073783,
        0.6398502447388389,
        0.6422106325626373,
        0.637419074231928,
        0.644311558116566,
        0.6406688104976307,
        0.6349317361008037,
        0.6378275242718783,
        0.6377015005458485,
        0.6376461668448015,
        0.6377138446677815,
        0.6377376128326763,
        0.6377811404791746,
        0.6376963209022175
      ],
      "val_accuracy": [
        0.3617294520547945,
        0.3690068493150685,
        0.3771404109589041,
        0.3971175799086758,
        0.4092465753424658,
        0.4195205479452055,
        0.4484874429223744,
        0.4402111872146119,
        0.4360730593607306,
        0.4479166666666667,
        0.4345034246575342,
        0.4444920091324201,
        0.4540525114155251,
        0.4486301369863014,
        0.4492009132420091,
        0.4492009132420091,
        0.4490582191780822,
        0.4492009132420091,
        0.4490582191780822,
        0.4493436073059361
      ],
      "val_f1": [
        0.3292847503373819,
        0.327350167325829,
        0.32524346885144534,
        0.32561851556264965,
        0.32463295269168024,
        0.3253731343283582,
        0.32630294579048286,
        0.3249010497332645,
        0.32490604714724974,
        0.32513518227803945,
        0.32314261315115284,
        0.3237797463956922,
        0.3259337561663143,
        0.32447552447552447,
        0.3242296918767507,
        0.3239929947460595,
        0.32417293891125504,
        0.3242296918767507,
        0.32417293891125504,
        0.3242864647172124
      ],
      "val_auroc": [
        0.6082998573297655,
        0.6097760157675082,
        0.6135301495882434,
        0.6143364957472874,
        0.6164296499867411,
        0.6144218202910239,
        0.6166192194995803,
        0.6176999483523524,
        0.6181720093126479,
        0.6186000930680383,
        0.6186534209078736,
        0.6189332094374205,
        0.619076464086622,
        0.6191351247104409,
        0.6193057007460785,
        0.6192796942926793,
        0.6193105952190496,
        0.6193035822428521,
        0.6193403273160537,
        0.6192975189405148
      ],
      "learning_rate": [
        0.000992403876506103,
        0.0009698463103929538,
        0.0009330127018922194,
        0.0008830222215594889,
        0.0008213938048432717,
        0.0007500000000000018,
        0.0006710100716628345,
        0.0005868240888334639,
        0.0004999999999999986,
        0.00041317591116653323,
        0.0003289899283371649,
        0.0002499999999999986,
        0.0001786061951567293,
        0.00011697777844051034,
        6.698729810778051e-05,
        3.0153689607045717e-05,
        7.596123493895977e-06,
        0.0,
        7.596123493895969e-06,
        3.015368960704586e-05
      ]
    },
    "final_metrics": {
      "loss": 0.6376963209022175,
      "accuracy": 0.4493436073059361,
      "precision": 0.20405464962538564,
      "recall": 0.7894288150042625,
      "f1": 0.3242864647172124,
      "auroc": 0.6192975189405148
    },
    "best_val_f1": 0.3292847503373819,
    "training_time": 199.53048133850098,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.1.hook_resid_pre",
    "hook_layer": 1,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.01,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples",
    "probe_name": "ntml_binary_4T1L_500samples_layer_1",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority"
  }
}