{
  "training_history": {
    "train_loss": [
      1.0699125013939321,
      1.028334890122283,
      1.0137716652868,
      1.0031505039973891,
      0.9951291778996655,
      0.9884831158946094,
      0.9839550266254983,
      0.9799397957243331,
      0.9756739053824176,
      0.9718569235442436,
      0.9691465294252247,
      0.9674620215343014,
      0.9652649061456663,
      0.9633964106576628,
      0.9633985016171791,
      0.9631097368453736,
      0.9604783882153088,
      0.9626639640494569,
      0.9618676469478433,
      0.9618971483212083
    ],
    "train_accuracy": [
      0.41262932572244027,
      0.4401712450945416,
      0.46803424901890833,
      0.4861933642525865,
      0.5087406350338922,
      0.519229397074563,
      0.5360684980378166,
      0.5326792722083482,
      0.5468069925080271,
      0.5518016410988227,
      0.556831965750981,
      0.5618979664645023,
      0.5579022475918659,
      0.5635390652871923,
      0.5668569389939351,
      0.5643239386371744,
      0.5678558687120941,
      0.5641098822689975,
      0.564823403496254,
      0.5642525865144488
    ],
    "val_loss": [
      0.637160753661936,
      0.6384451774033633,
      0.634378498250788,
      0.6225652981888165,
      0.6224038741805337,
      0.6021014961329374,
      0.6310418833385815,
      0.6138049737973647,
      0.6170518387447704,
      0.6156180696053939,
      0.6216483647173101,
      0.6227029496973211,
      0.6144110387021845,
      0.6126950990069996,
      0.613146406953985,
      0.6139652880755337,
      0.6139270424842834,
      0.614051015810533,
      0.6142057044939562,
      0.6139741854234175
    ],
    "val_accuracy": [
      0.4293664383561644,
      0.4202340182648402,
      0.4427796803652968,
      0.4860159817351598,
      0.4910102739726027,
      0.5490867579908676,
      0.478453196347032,
      0.5235445205479452,
      0.5186929223744292,
      0.523972602739726,
      0.511843607305936,
      0.5107020547945206,
      0.5299657534246576,
      0.5349600456621004,
      0.5332477168949772,
      0.5319634703196348,
      0.5321061643835616,
      0.5316780821917808,
      0.531107305936073,
      0.5319634703196348
    ],
    "val_f1": [
      0.34064303380049465,
      0.3452054794520548,
      0.3468807492891788,
      0.35052289938694553,
      0.3515724413742956,
      0.34952655413750516,
      0.35091458000355175,
      0.3550318717403902,
      0.35543665201605196,
      0.35573580533024335,
      0.35562252778300996,
      0.3546019198193111,
      0.3573936792820913,
      0.3583382555621185,
      0.35749361618542524,
      0.3576184880532707,
      0.3574368018812463,
      0.3572267920094007,
      0.3574501368791553,
      0.3576184880532707
    ],
    "val_auroc": [
      0.6265306828247468,
      0.6438493543708336,
      0.6499979884743107,
      0.6541082059661147,
      0.6565682665942045,
      0.6597543115465103,
      0.6602980587012601,
      0.6618927398038585,
      0.6629667533622475,
      0.6631695292676987,
      0.6636940787035894,
      0.6643182163060625,
      0.6645850787141763,
      0.6647638574710535,
      0.6648664805711322,
      0.6649224503911888,
      0.6649014175962621,
      0.6649021939745983,
      0.6649307082334923,
      0.6649840665991453
    ],
    "learning_rate": [
      0.000992403876506103,
      0.0009698463103929538,
      0.0009330127018922194,
      0.0008830222215594889,
      0.0008213938048432717,
      0.0007500000000000018,
      0.0006710100716628345,
      0.0005868240888334639,
      0.0004999999999999986,
      0.00041317591116653323,
      0.0003289899283371649,
      0.0002499999999999986,
      0.0001786061951567293,
      0.00011697777844051034,
      6.698729810778051e-05,
      3.0153689607045717e-05,
      7.596123493895977e-06,
      0.0,
      7.596123493895969e-06,
      3.015368960704586e-05
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.2.hook_resid_pre",
      "hook_layer": 2,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.01,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples",
      "probe_name": "ntml_binary_4T1L_500samples_layer_2",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority"
    },
    "training_history": {
      "train_loss": [
        1.0699125013939321,
        1.028334890122283,
        1.0137716652868,
        1.0031505039973891,
        0.9951291778996655,
        0.9884831158946094,
        0.9839550266254983,
        0.9799397957243331,
        0.9756739053824176,
        0.9718569235442436,
        0.9691465294252247,
        0.9674620215343014,
        0.9652649061456663,
        0.9633964106576628,
        0.9633985016171791,
        0.9631097368453736,
        0.9604783882153088,
        0.9626639640494569,
        0.9618676469478433,
        0.9618971483212083
      ],
      "train_accuracy": [
        0.41262932572244027,
        0.4401712450945416,
        0.46803424901890833,
        0.4861933642525865,
        0.5087406350338922,
        0.519229397074563,
        0.5360684980378166,
        0.5326792722083482,
        0.5468069925080271,
        0.5518016410988227,
        0.556831965750981,
        0.5618979664645023,
        0.5579022475918659,
        0.5635390652871923,
        0.5668569389939351,
        0.5643239386371744,
        0.5678558687120941,
        0.5641098822689975,
        0.564823403496254,
        0.5642525865144488
      ],
      "val_loss": [
        0.637160753661936,
        0.6384451774033633,
        0.634378498250788,
        0.6225652981888165,
        0.6224038741805337,
        0.6021014961329374,
        0.6310418833385815,
        0.6138049737973647,
        0.6170518387447704,
        0.6156180696053939,
        0.6216483647173101,
        0.6227029496973211,
        0.6144110387021845,
        0.6126950990069996,
        0.613146406953985,
        0.6139652880755337,
        0.6139270424842834,
        0.614051015810533,
        0.6142057044939562,
        0.6139741854234175
      ],
      "val_accuracy": [
        0.4293664383561644,
        0.4202340182648402,
        0.4427796803652968,
        0.4860159817351598,
        0.4910102739726027,
        0.5490867579908676,
        0.478453196347032,
        0.5235445205479452,
        0.5186929223744292,
        0.523972602739726,
        0.511843607305936,
        0.5107020547945206,
        0.5299657534246576,
        0.5349600456621004,
        0.5332477168949772,
        0.5319634703196348,
        0.5321061643835616,
        0.5316780821917808,
        0.531107305936073,
        0.5319634703196348
      ],
      "val_f1": [
        0.34064303380049465,
        0.3452054794520548,
        0.3468807492891788,
        0.35052289938694553,
        0.3515724413742956,
        0.34952655413750516,
        0.35091458000355175,
        0.3550318717403902,
        0.35543665201605196,
        0.35573580533024335,
        0.35562252778300996,
        0.3546019198193111,
        0.3573936792820913,
        0.3583382555621185,
        0.35749361618542524,
        0.3576184880532707,
        0.3574368018812463,
        0.3572267920094007,
        0.3574501368791553,
        0.3576184880532707
      ],
      "val_auroc": [
        0.6265306828247468,
        0.6438493543708336,
        0.6499979884743107,
        0.6541082059661147,
        0.6565682665942045,
        0.6597543115465103,
        0.6602980587012601,
        0.6618927398038585,
        0.6629667533622475,
        0.6631695292676987,
        0.6636940787035894,
        0.6643182163060625,
        0.6645850787141763,
        0.6647638574710535,
        0.6648664805711322,
        0.6649224503911888,
        0.6649014175962621,
        0.6649021939745983,
        0.6649307082334923,
        0.6649840665991453
      ],
      "learning_rate": [
        0.000992403876506103,
        0.0009698463103929538,
        0.0009330127018922194,
        0.0008830222215594889,
        0.0008213938048432717,
        0.0007500000000000018,
        0.0006710100716628345,
        0.0005868240888334639,
        0.0004999999999999986,
        0.00041317591116653323,
        0.0003289899283371649,
        0.0002499999999999986,
        0.0001786061951567293,
        0.00011697777844051034,
        6.698729810778051e-05,
        3.0153689607045717e-05,
        7.596123493895977e-06,
        0.0,
        7.596123493895969e-06,
        3.015368960704586e-05
      ]
    },
    "final_metrics": {
      "loss": 0.6139741854234175,
      "accuracy": 0.5319634703196348,
      "precision": 0.2352486472558619,
      "recall": 0.7453061224489796,
      "f1": 0.3576184880532707,
      "auroc": 0.6649840665991453
    },
    "best_val_f1": 0.3583382555621185,
    "training_time": 198.90825486183167,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.2.hook_resid_pre",
    "hook_layer": 2,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.01,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples",
    "probe_name": "ntml_binary_4T1L_500samples_layer_2",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority"
  }
}