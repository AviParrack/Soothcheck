{
  "training_history": {
    "train_loss": [
      1.0563687126930446,
      1.016694652435442,
      1.0008462062573324,
      0.9887671862563042,
      0.9788388123387071,
      0.9706141463561689,
      0.9656641535699095,
      0.9600454325273157,
      0.9555045843260473,
      0.9510646490337642,
      0.9487109004634701,
      0.9454957881610687,
      0.9431260538427797,
      0.9401565294151437,
      0.9400109442537778,
      0.9400803414790053,
      0.9389118117420641,
      0.9386277245400159,
      0.9394856187850917,
      0.9385773591254944
    ],
    "train_accuracy": [
      0.413699607563325,
      0.46361041740991793,
      0.5114163396361042,
      0.5328219764537995,
      0.5504816268283982,
      0.5683910096325365,
      0.5696396717802354,
      0.5841241526935427,
      0.5879058151980021,
      0.595718872636461,
      0.5981091687477702,
      0.5997145915090974,
      0.6062076346771317,
      0.5968961826614342,
      0.6088833392793436,
      0.6140920442383161,
      0.6083481983589012,
      0.6060649304316803,
      0.6049946485907955,
      0.6104530859793079
    ],
    "val_loss": [
      0.6239574952559037,
      0.6328789342533458,
      0.6066299525174228,
      0.5998280297626148,
      0.608044771714644,
      0.6190105519511483,
      0.5963241848078641,
      0.6114986972375349,
      0.6036028764464638,
      0.6042046736587178,
      0.6013998746871948,
      0.5991634515198794,
      0.6043270436200229,
      0.5948293523354964,
      0.5974753206426447,
      0.5991180950945074,
      0.6005265940319408,
      0.6011285126209259,
      0.6010497851805253,
      0.6012033489617434
    ],
    "val_accuracy": [
      0.447060502283105,
      0.4579052511415525,
      0.5351027397260274,
      0.5490867579908676,
      0.5392408675799086,
      0.5185502283105022,
      0.567208904109589,
      0.5412385844748858,
      0.557505707762557,
      0.5557933789954338,
      0.5625,
      0.5653538812785388,
      0.5543664383561644,
      0.5737728310502284,
      0.56949200913242,
      0.5654965753424658,
      0.5627853881278538,
      0.5619292237442922,
      0.5620719178082192,
      0.5617865296803652
    ],
    "val_f1": [
      0.353628023352794,
      0.35621081172682595,
      0.3528009535160906,
      0.3566775244299674,
      0.3589438157633512,
      0.3629154078549849,
      0.35755136623596695,
      0.36197658265528876,
      0.36180284009055363,
      0.36378499897813205,
      0.36469125569830085,
      0.3630280217482225,
      0.36304303487660616,
      0.361615729856807,
      0.36336779911373707,
      0.3633702697052059,
      0.3632585203657523,
      0.3633347158855247,
      0.3634100808960797,
      0.36352331606217614
    ],
    "val_auroc": [
      0.6552341951244739,
      0.6614594341340791,
      0.6679099391346188,
      0.6725551543332015,
      0.6772931178499478,
      0.6800247666115049,
      0.6801906596260388,
      0.6808446757968485,
      0.6829149306804692,
      0.6825492774624959,
      0.6839984699338058,
      0.6838383385572184,
      0.6844322791128539,
      0.6845503224268806,
      0.6845317024993705,
      0.6846191107628521,
      0.6846446165503471,
      0.6846622527835737,
      0.6846964010279887,
      0.6846513618825772
    ],
    "learning_rate": [
      0.000992403876506103,
      0.0009698463103929538,
      0.0009330127018922194,
      0.0008830222215594889,
      0.0008213938048432717,
      0.0007500000000000018,
      0.0006710100716628345,
      0.0005868240888334639,
      0.0004999999999999986,
      0.00041317591116653323,
      0.0003289899283371649,
      0.0002499999999999986,
      0.0001786061951567293,
      0.00011697777844051034,
      6.698729810778051e-05,
      3.0153689607045717e-05,
      7.596123493895977e-06,
      0.0,
      7.596123493895969e-06,
      3.015368960704586e-05
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.3.hook_resid_pre",
      "hook_layer": 3,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.01,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples",
      "probe_name": "ntml_binary_4T1L_500samples_layer_3",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority"
    },
    "training_history": {
      "train_loss": [
        1.0563687126930446,
        1.016694652435442,
        1.0008462062573324,
        0.9887671862563042,
        0.9788388123387071,
        0.9706141463561689,
        0.9656641535699095,
        0.9600454325273157,
        0.9555045843260473,
        0.9510646490337642,
        0.9487109004634701,
        0.9454957881610687,
        0.9431260538427797,
        0.9401565294151437,
        0.9400109442537778,
        0.9400803414790053,
        0.9389118117420641,
        0.9386277245400159,
        0.9394856187850917,
        0.9385773591254944
      ],
      "train_accuracy": [
        0.413699607563325,
        0.46361041740991793,
        0.5114163396361042,
        0.5328219764537995,
        0.5504816268283982,
        0.5683910096325365,
        0.5696396717802354,
        0.5841241526935427,
        0.5879058151980021,
        0.595718872636461,
        0.5981091687477702,
        0.5997145915090974,
        0.6062076346771317,
        0.5968961826614342,
        0.6088833392793436,
        0.6140920442383161,
        0.6083481983589012,
        0.6060649304316803,
        0.6049946485907955,
        0.6104530859793079
      ],
      "val_loss": [
        0.6239574952559037,
        0.6328789342533458,
        0.6066299525174228,
        0.5998280297626148,
        0.608044771714644,
        0.6190105519511483,
        0.5963241848078641,
        0.6114986972375349,
        0.6036028764464638,
        0.6042046736587178,
        0.6013998746871948,
        0.5991634515198794,
        0.6043270436200229,
        0.5948293523354964,
        0.5974753206426447,
        0.5991180950945074,
        0.6005265940319408,
        0.6011285126209259,
        0.6010497851805253,
        0.6012033489617434
      ],
      "val_accuracy": [
        0.447060502283105,
        0.4579052511415525,
        0.5351027397260274,
        0.5490867579908676,
        0.5392408675799086,
        0.5185502283105022,
        0.567208904109589,
        0.5412385844748858,
        0.557505707762557,
        0.5557933789954338,
        0.5625,
        0.5653538812785388,
        0.5543664383561644,
        0.5737728310502284,
        0.56949200913242,
        0.5654965753424658,
        0.5627853881278538,
        0.5619292237442922,
        0.5620719178082192,
        0.5617865296803652
      ],
      "val_f1": [
        0.353628023352794,
        0.35621081172682595,
        0.3528009535160906,
        0.3566775244299674,
        0.3589438157633512,
        0.3629154078549849,
        0.35755136623596695,
        0.36197658265528876,
        0.36180284009055363,
        0.36378499897813205,
        0.36469125569830085,
        0.3630280217482225,
        0.36304303487660616,
        0.361615729856807,
        0.36336779911373707,
        0.3633702697052059,
        0.3632585203657523,
        0.3633347158855247,
        0.3634100808960797,
        0.36352331606217614
      ],
      "val_auroc": [
        0.6552341951244739,
        0.6614594341340791,
        0.6679099391346188,
        0.6725551543332015,
        0.6772931178499478,
        0.6800247666115049,
        0.6801906596260388,
        0.6808446757968485,
        0.6829149306804692,
        0.6825492774624959,
        0.6839984699338058,
        0.6838383385572184,
        0.6844322791128539,
        0.6845503224268806,
        0.6845317024993705,
        0.6846191107628521,
        0.6846446165503471,
        0.6846622527835737,
        0.6846964010279887,
        0.6846513618825772
      ],
      "learning_rate": [
        0.000992403876506103,
        0.0009698463103929538,
        0.0009330127018922194,
        0.0008830222215594889,
        0.0008213938048432717,
        0.0007500000000000018,
        0.0006710100716628345,
        0.0005868240888334639,
        0.0004999999999999986,
        0.00041317591116653323,
        0.0003289899283371649,
        0.0002499999999999986,
        0.0001786061951567293,
        0.00011697777844051034,
        6.698729810778051e-05,
        3.0153689607045717e-05,
        7.596123493895977e-06,
        0.0,
        7.596123493895969e-06,
        3.015368960704586e-05
      ]
    },
    "final_metrics": {
      "loss": 0.6012033489617434,
      "accuracy": 0.5617865296803652,
      "precision": 0.24408572223768438,
      "recall": 0.7118506493506493,
      "f1": 0.36352331606217614,
      "auroc": 0.6846513618825772
    },
    "best_val_f1": 0.36469125569830085,
    "training_time": 199.32722544670105,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.3.hook_resid_pre",
    "hook_layer": 3,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.01,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples",
    "probe_name": "ntml_binary_4T1L_500samples_layer_3",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority"
  }
}