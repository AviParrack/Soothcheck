{
  "training_history": {
    "train_loss": [
      1.0479495463442041,
      1.0016238503668407,
      0.9805268618069827,
      0.9643023504650212,
      0.9533723352570512,
      0.9426520799529062,
      0.9335504728773413,
      0.9252291418373857,
      0.9220040133010307,
      0.9174299172070473,
      0.9123558520114041,
      0.9090204007209164,
      0.9081206619059115,
      0.9046433571402885,
      0.9031506900645826,
      0.9032588524225096,
      0.8998637816881481,
      0.9024136540007918,
      0.9001923978464789,
      0.9017642057377454
    ],
    "train_accuracy": [
      0.4385301462718516,
      0.509418480199786,
      0.5497324295397789,
      0.5770246164823404,
      0.5920799143774528,
      0.6109525508383874,
      0.6150196218337496,
      0.6265073135925794,
      0.6347841598287549,
      0.6339279343560471,
      0.6426328933285765,
      0.6431680342490189,
      0.643952907599001,
      0.6472707813057439,
      0.6538708526578666,
      0.6457367106671423,
      0.6444166963967178,
      0.650517302889761,
      0.6514448804851944,
      0.6499464859079558
    ],
    "val_loss": [
      0.6183334675702181,
      0.6451444604180075,
      0.635990537296642,
      0.6329034946181558,
      0.6105431350794706,
      0.6366618205200542,
      0.6004476260055195,
      0.5858125507831573,
      0.5973856056278403,
      0.5955436752601103,
      0.5922321671789342,
      0.5888396794145757,
      0.5954235832799565,
      0.5889008947394111,
      0.5967420987107537,
      0.5959316470406272,
      0.5950727581977844,
      0.5941664397716522,
      0.5941429745067249,
      0.5940774064172398
    ],
    "val_accuracy": [
      0.5055650684931506,
      0.4643264840182648,
      0.4911529680365297,
      0.5159817351598174,
      0.5625,
      0.5201198630136986,
      0.5851883561643836,
      0.6164383561643836,
      0.5943207762557078,
      0.5950342465753424,
      0.6037385844748858,
      0.6075913242009132,
      0.5974600456621004,
      0.6085901826484018,
      0.5946061643835616,
      0.596175799086758,
      0.5977454337899544,
      0.6000285388127854,
      0.6003139269406392,
      0.5997431506849316
    ],
    "val_f1": [
      0.3488066152978763,
      0.3563100137174211,
      0.3597845601436266,
      0.3662182361733931,
      0.36809563066776585,
      0.3691615081598199,
      0.3725447873947766,
      0.37371854613233924,
      0.37420206911732334,
      0.37350993377483444,
      0.3769351581781467,
      0.3752839618355293,
      0.37685001104484206,
      0.3775811209439528,
      0.3754671356342053,
      0.37527593818984545,
      0.37563676633444076,
      0.3764182424916574,
      0.37658580013354104,
      0.3759733036707453
    ],
    "val_auroc": [
      0.6624237264648153,
      0.6779390442125255,
      0.6862695000136304,
      0.6920076920979936,
      0.6984892387867112,
      0.6998730099592905,
      0.7019909778005962,
      0.7040065755397644,
      0.706048156259087,
      0.7061694811582219,
      0.7084140982798415,
      0.7077791480762939,
      0.7084323431593487,
      0.7087067972611951,
      0.7084241081164582,
      0.7085704931030097,
      0.7086079767465105,
      0.7086698105599375,
      0.7086692426259451,
      0.7085895898835055
    ],
    "learning_rate": [
      0.000992403876506103,
      0.0009698463103929538,
      0.0009330127018922194,
      0.0008830222215594889,
      0.0008213938048432717,
      0.0007500000000000018,
      0.0006710100716628345,
      0.0005868240888334639,
      0.0004999999999999986,
      0.00041317591116653323,
      0.0003289899283371649,
      0.0002499999999999986,
      0.0001786061951567293,
      0.00011697777844051034,
      6.698729810778051e-05,
      3.0153689607045717e-05,
      7.596123493895977e-06,
      0.0,
      7.596123493895969e-06,
      3.015368960704586e-05
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.4.hook_resid_pre",
      "hook_layer": 4,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.01,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples",
      "probe_name": "ntml_binary_4T1L_500samples_layer_4",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority"
    },
    "training_history": {
      "train_loss": [
        1.0479495463442041,
        1.0016238503668407,
        0.9805268618069827,
        0.9643023504650212,
        0.9533723352570512,
        0.9426520799529062,
        0.9335504728773413,
        0.9252291418373857,
        0.9220040133010307,
        0.9174299172070473,
        0.9123558520114041,
        0.9090204007209164,
        0.9081206619059115,
        0.9046433571402885,
        0.9031506900645826,
        0.9032588524225096,
        0.8998637816881481,
        0.9024136540007918,
        0.9001923978464789,
        0.9017642057377454
      ],
      "train_accuracy": [
        0.4385301462718516,
        0.509418480199786,
        0.5497324295397789,
        0.5770246164823404,
        0.5920799143774528,
        0.6109525508383874,
        0.6150196218337496,
        0.6265073135925794,
        0.6347841598287549,
        0.6339279343560471,
        0.6426328933285765,
        0.6431680342490189,
        0.643952907599001,
        0.6472707813057439,
        0.6538708526578666,
        0.6457367106671423,
        0.6444166963967178,
        0.650517302889761,
        0.6514448804851944,
        0.6499464859079558
      ],
      "val_loss": [
        0.6183334675702181,
        0.6451444604180075,
        0.635990537296642,
        0.6329034946181558,
        0.6105431350794706,
        0.6366618205200542,
        0.6004476260055195,
        0.5858125507831573,
        0.5973856056278403,
        0.5955436752601103,
        0.5922321671789342,
        0.5888396794145757,
        0.5954235832799565,
        0.5889008947394111,
        0.5967420987107537,
        0.5959316470406272,
        0.5950727581977844,
        0.5941664397716522,
        0.5941429745067249,
        0.5940774064172398
      ],
      "val_accuracy": [
        0.5055650684931506,
        0.4643264840182648,
        0.4911529680365297,
        0.5159817351598174,
        0.5625,
        0.5201198630136986,
        0.5851883561643836,
        0.6164383561643836,
        0.5943207762557078,
        0.5950342465753424,
        0.6037385844748858,
        0.6075913242009132,
        0.5974600456621004,
        0.6085901826484018,
        0.5946061643835616,
        0.596175799086758,
        0.5977454337899544,
        0.6000285388127854,
        0.6003139269406392,
        0.5997431506849316
      ],
      "val_f1": [
        0.3488066152978763,
        0.3563100137174211,
        0.3597845601436266,
        0.3662182361733931,
        0.36809563066776585,
        0.3691615081598199,
        0.3725447873947766,
        0.37371854613233924,
        0.37420206911732334,
        0.37350993377483444,
        0.3769351581781467,
        0.3752839618355293,
        0.37685001104484206,
        0.3775811209439528,
        0.3754671356342053,
        0.37527593818984545,
        0.37563676633444076,
        0.3764182424916574,
        0.37658580013354104,
        0.3759733036707453
      ],
      "val_auroc": [
        0.6624237264648153,
        0.6779390442125255,
        0.6862695000136304,
        0.6920076920979936,
        0.6984892387867112,
        0.6998730099592905,
        0.7019909778005962,
        0.7040065755397644,
        0.706048156259087,
        0.7061694811582219,
        0.7084140982798415,
        0.7077791480762939,
        0.7084323431593487,
        0.7087067972611951,
        0.7084241081164582,
        0.7085704931030097,
        0.7086079767465105,
        0.7086698105599375,
        0.7086692426259451,
        0.7085895898835055
      ],
      "learning_rate": [
        0.000992403876506103,
        0.0009698463103929538,
        0.0009330127018922194,
        0.0008830222215594889,
        0.0008213938048432717,
        0.0007500000000000018,
        0.0006710100716628345,
        0.0005868240888334639,
        0.0004999999999999986,
        0.00041317591116653323,
        0.0003289899283371649,
        0.0002499999999999986,
        0.0001786061951567293,
        0.00011697777844051034,
        6.698729810778051e-05,
        3.0153689607045717e-05,
        7.596123493895977e-06,
        0.0,
        7.596123493895969e-06,
        3.015368960704586e-05
      ]
    },
    "final_metrics": {
      "loss": 0.5940774064172398,
      "accuracy": 0.5997431506849316,
      "precision": 0.25770051845074715,
      "recall": 0.6949013157894737,
      "f1": 0.3759733036707453,
      "auroc": 0.7085895898835055
    },
    "best_val_f1": 0.3775811209439528,
    "training_time": 202.63755869865417,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.4.hook_resid_pre",
    "hook_layer": 4,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.01,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples",
    "probe_name": "ntml_binary_4T1L_500samples_layer_4",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority"
  }
}