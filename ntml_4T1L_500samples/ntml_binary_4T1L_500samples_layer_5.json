{
  "training_history": {
    "train_loss": [
      1.0347026451809767,
      0.9833259898233632,
      0.9584110610561284,
      0.940949764868168,
      0.927796361585186,
      0.915324002368265,
      0.9068939212930801,
      0.8975605620028766,
      0.8911772855476702,
      0.8859947342170428,
      0.8826883827850699,
      0.8795432362994647,
      0.8750393340304562,
      0.871874527776078,
      0.8713753201986012,
      0.8709637636667518,
      0.8687995236418019,
      0.8709262673100925,
      0.8701554881451337,
      0.8682456679948388
    ],
    "train_accuracy": [
      0.48847663217980736,
      0.5636460934712808,
      0.604709240099893,
      0.6252229753835177,
      0.63863717445594,
      0.6528362468783446,
      0.6583303603282198,
      0.6667855868712094,
      0.671994291830182,
      0.6759186585800928,
      0.6794149125936496,
      0.6836246878344631,
      0.6833749554049233,
      0.6900820549411345,
      0.6834819835890118,
      0.6892258294684267,
      0.6890117731002497,
      0.6899393506956832,
      0.6900463788797717,
      0.6902247591865858
    ],
    "val_loss": [
      0.6163200936534188,
      0.6096874426711689,
      0.6217730072411624,
      0.5970530173995278,
      0.5983656693588604,
      0.5968996001915499,
      0.5918166025118394,
      0.5700549038973721,
      0.5839542150497437,
      0.5751266157085245,
      0.5722121926871213,
      0.5693967770446431,
      0.5595391235568307,
      0.5769285795363512,
      0.5713335901498795,
      0.5718016001311216,
      0.5719387669454922,
      0.5718524567105553,
      0.5714036424051632,
      0.5710461990399794
    ],
    "val_accuracy": [
      0.5272545662100456,
      0.5627853881278538,
      0.5459474885844748,
      0.5993150684931506,
      0.6005993150684932,
      0.6060216894977168,
      0.6191495433789954,
      0.653681506849315,
      0.6278538812785388,
      0.6454052511415526,
      0.6494006849315068,
      0.6541095890410958,
      0.6662385844748858,
      0.6408390410958904,
      0.6505422374429224,
      0.6496860730593608,
      0.64925799086758,
      0.6496860730593608,
      0.6502568493150684,
      0.6502568493150684
    ],
    "val_f1": [
      0.358567279767667,
      0.3669421487603306,
      0.3738685556867375,
      0.3790358248562583,
      0.3811629449480433,
      0.3914480934538241,
      0.3940976163450624,
      0.38912660458092124,
      0.3976905311778291,
      0.40307470574105214,
      0.40175310445580714,
      0.40177690029615004,
      0.4001025904077969,
      0.40256349394730595,
      0.4037009982955929,
      0.40398154891964067,
      0.4036875303250849,
      0.4036920087442312,
      0.40379469715397714,
      0.40321402483564645
    ],
    "val_auroc": [
      0.6746359058311713,
      0.6914149682214191,
      0.7024987396195634,
      0.7068529999886708,
      0.7114232952292476,
      0.716216918553933,
      0.7185974798055899,
      0.7196846641440175,
      0.7225900534741183,
      0.7241044926189856,
      0.724552423329217,
      0.7248541357472216,
      0.725879858837391,
      0.7259697848573079,
      0.726271355659533,
      0.7263693537788756,
      0.7264577928331086,
      0.7264551021333001,
      0.7264643779668506,
      0.7265131646028526
    ],
    "learning_rate": [
      0.000992403876506103,
      0.0009698463103929538,
      0.0009330127018922194,
      0.0008830222215594889,
      0.0008213938048432717,
      0.0007500000000000018,
      0.0006710100716628345,
      0.0005868240888334639,
      0.0004999999999999986,
      0.00041317591116653323,
      0.0003289899283371649,
      0.0002499999999999986,
      0.0001786061951567293,
      0.00011697777844051034,
      6.698729810778051e-05,
      3.0153689607045717e-05,
      7.596123493895977e-06,
      0.0,
      7.596123493895969e-06,
      3.015368960704586e-05
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.5.hook_resid_pre",
      "hook_layer": 5,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.01,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples",
      "probe_name": "ntml_binary_4T1L_500samples_layer_5",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority"
    },
    "training_history": {
      "train_loss": [
        1.0347026451809767,
        0.9833259898233632,
        0.9584110610561284,
        0.940949764868168,
        0.927796361585186,
        0.915324002368265,
        0.9068939212930801,
        0.8975605620028766,
        0.8911772855476702,
        0.8859947342170428,
        0.8826883827850699,
        0.8795432362994647,
        0.8750393340304562,
        0.871874527776078,
        0.8713753201986012,
        0.8709637636667518,
        0.8687995236418019,
        0.8709262673100925,
        0.8701554881451337,
        0.8682456679948388
      ],
      "train_accuracy": [
        0.48847663217980736,
        0.5636460934712808,
        0.604709240099893,
        0.6252229753835177,
        0.63863717445594,
        0.6528362468783446,
        0.6583303603282198,
        0.6667855868712094,
        0.671994291830182,
        0.6759186585800928,
        0.6794149125936496,
        0.6836246878344631,
        0.6833749554049233,
        0.6900820549411345,
        0.6834819835890118,
        0.6892258294684267,
        0.6890117731002497,
        0.6899393506956832,
        0.6900463788797717,
        0.6902247591865858
      ],
      "val_loss": [
        0.6163200936534188,
        0.6096874426711689,
        0.6217730072411624,
        0.5970530173995278,
        0.5983656693588604,
        0.5968996001915499,
        0.5918166025118394,
        0.5700549038973721,
        0.5839542150497437,
        0.5751266157085245,
        0.5722121926871213,
        0.5693967770446431,
        0.5595391235568307,
        0.5769285795363512,
        0.5713335901498795,
        0.5718016001311216,
        0.5719387669454922,
        0.5718524567105553,
        0.5714036424051632,
        0.5710461990399794
      ],
      "val_accuracy": [
        0.5272545662100456,
        0.5627853881278538,
        0.5459474885844748,
        0.5993150684931506,
        0.6005993150684932,
        0.6060216894977168,
        0.6191495433789954,
        0.653681506849315,
        0.6278538812785388,
        0.6454052511415526,
        0.6494006849315068,
        0.6541095890410958,
        0.6662385844748858,
        0.6408390410958904,
        0.6505422374429224,
        0.6496860730593608,
        0.64925799086758,
        0.6496860730593608,
        0.6502568493150684,
        0.6502568493150684
      ],
      "val_f1": [
        0.358567279767667,
        0.3669421487603306,
        0.3738685556867375,
        0.3790358248562583,
        0.3811629449480433,
        0.3914480934538241,
        0.3940976163450624,
        0.38912660458092124,
        0.3976905311778291,
        0.40307470574105214,
        0.40175310445580714,
        0.40177690029615004,
        0.4001025904077969,
        0.40256349394730595,
        0.4037009982955929,
        0.40398154891964067,
        0.4036875303250849,
        0.4036920087442312,
        0.40379469715397714,
        0.40321402483564645
      ],
      "val_auroc": [
        0.6746359058311713,
        0.6914149682214191,
        0.7024987396195634,
        0.7068529999886708,
        0.7114232952292476,
        0.716216918553933,
        0.7185974798055899,
        0.7196846641440175,
        0.7225900534741183,
        0.7241044926189856,
        0.724552423329217,
        0.7248541357472216,
        0.725879858837391,
        0.7259697848573079,
        0.726271355659533,
        0.7263693537788756,
        0.7264577928331086,
        0.7264551021333001,
        0.7264643779668506,
        0.7265131646028526
      ],
      "learning_rate": [
        0.000992403876506103,
        0.0009698463103929538,
        0.0009330127018922194,
        0.0008830222215594889,
        0.0008213938048432717,
        0.0007500000000000018,
        0.0006710100716628345,
        0.0005868240888334639,
        0.0004999999999999986,
        0.00041317591116653323,
        0.0003289899283371649,
        0.0002499999999999986,
        0.0001786061951567293,
        0.00011697777844051034,
        6.698729810778051e-05,
        3.0153689607045717e-05,
        7.596123493895977e-06,
        0.0,
        7.596123493895969e-06,
        3.015368960704586e-05
      ]
    },
    "final_metrics": {
      "loss": 0.5710461990399794,
      "accuracy": 0.6502568493150684,
      "precision": 0.28680290959473503,
      "recall": 0.6786885245901639,
      "f1": 0.40321402483564645,
      "auroc": 0.7265131646028526
    },
    "best_val_f1": 0.40398154891964067,
    "training_time": 201.9266495704651,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.5.hook_resid_pre",
    "hook_layer": 5,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.01,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples",
    "probe_name": "ntml_binary_4T1L_500samples_layer_5",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority"
  }
}