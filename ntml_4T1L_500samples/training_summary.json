{
  "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
  "model_name": "meta-llama/Llama-3.1-8B-Instruct",
  "layers_attempted": [
    0,
    1,
    2,
    3,
    4,
    5,
    6,
    7,
    8,
    9,
    10,
    11,
    12,
    13,
    14,
    15,
    16,
    17,
    18,
    19,
    20,
    21,
    22,
    23,
    24,
    25,
    26,
    27,
    28,
    29,
    30,
    31
  ],
  "successful_layers": [
    0,
    1,
    2,
    3,
    4,
    5
  ],
  "failed_layers": [
    6
  ],
  "total_time": 1612.11159658432,
  "results": {
    "0": {
      "config": {
        "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
        "max_length": 512,
        "model_name": "meta-llama/Llama-3.1-8B-Instruct",
        "hook_point": "blocks.0.hook_resid_pre",
        "hook_layer": 0,
        "device": "cuda",
        "dtype": "bfloat16",
        "batch_size": 32,
        "learning_rate": 0.001,
        "num_epochs": 20,
        "weight_decay": 0.01,
        "train_ratio": 0.8,
        "handle_class_imbalance": true,
        "optimizer_type": "AdamW",
        "scheduler_type": "cosine",
        "warmup_ratio": 0.1,
        "gradient_clip_norm": 1.0,
        "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
        "activation_batch_size": 16,
        "force_recache": false,
        "output_dir": "./ntml_4T1L_500samples",
        "probe_name": "ntml_binary_4T1L_500samples_layer_0",
        "save_checkpoints": true,
        "checkpoint_every": 5,
        "verbose": true,
        "log_every": 10,
        "eval_every": 1,
        "ignore_system_tokens": true,
        "ignore_user_tokens": true,
        "min_tokens_per_statement": 1,
        "token_overlap_strategy": "majority"
      },
      "training_results": {
        "training_history": {
          "train_loss": [
            1.1189658479195208,
            1.0816684497273676,
            1.0641788593302035,
            1.0533761444021033,
            1.0460419381318027,
            1.0408892394745186,
            1.0363419866316939,
            1.0335546479513655,
            1.0305829749668025,
            1.0282561227883378,
            1.0268853892610497,
            1.0247814561406228,
            1.0237166352195828,
            1.0240150714573795,
            1.0231700150389649,
            1.022677103066009,
            1.0218895654700118,
            1.021732718024624,
            1.0222376267251359,
            1.0221386672971455
          ],
          "train_accuracy": [
            0.4216553692472351,
            0.41933642525865145,
            0.4286122012129861,
            0.425365679628969,
            0.44673564038530145,
            0.4322868355333571,
            0.444987513378523,
            0.4356403853014627,
            0.4426328933285765,
            0.43182304673564037,
            0.43842311808776313,
            0.4403496254013557,
            0.44951837317160187,
            0.4459864430966821,
            0.446414555833036,
            0.44991080984659293,
            0.44798430253300037,
            0.44880485194434533,
            0.4476275419193721,
            0.4489118801284338
          ],
          "val_loss": [
            0.6692233730446209,
            0.6622499677267941,
            0.658925817229531,
            0.6425673939964988,
            0.6590306840159676,
            0.6454411154443568,
            0.6515050400387157,
            0.6499749091538516,
            0.6510882702740756,
            0.6453014991500161,
            0.6417196766896681,
            0.6410918279127641,
            0.6419849504124034,
            0.6419722177765587,
            0.6414753989739852,
            0.6408495052294297,
            0.6407322059978139,
            0.6408032205971804,
            0.6407457221638072,
            0.6405932307243347
          ],
          "val_accuracy": [
            0.4053938356164384,
            0.4096746575342466,
            0.40625,
            0.4295091324200913,
            0.4089611872146119,
            0.4267979452054795,
            0.3891267123287671,
            0.394263698630137,
            0.3946917808219178,
            0.4018264840182648,
            0.4069634703196347,
            0.4096746575342466,
            0.4092465753424658,
            0.4091038812785388,
            0.4093892694063927,
            0.4098173515981735,
            0.4098173515981735,
            0.4098173515981735,
            0.4098173515981735,
            0.4098173515981735
          ],
          "val_f1": [
            0.3174447174447175,
            0.31811438931926816,
            0.321760391198044,
            0.3228319783197832,
            0.32098360655737707,
            0.323167649536647,
            0.3274155538098979,
            0.32779097387173395,
            0.3277337559429477,
            0.3271268057784912,
            0.32598118715536817,
            0.3269887750122011,
            0.3266102797657775,
            0.32633805108182856,
            0.3262249715122904,
            0.32616487455197135,
            0.32616487455197135,
            0.32616487455197135,
            0.3259452411994785,
            0.3259452411994785
          ],
          "val_auroc": [
            0.5995762661824837,
            0.6060863853091832,
            0.6090924523567011,
            0.6120485511418154,
            0.6109099833193097,
            0.6130492449404367,
            0.6150701179457656,
            0.6158084968188595,
            0.6158766219387981,
            0.6166980352213512,
            0.6176317110254934,
            0.6174549399938001,
            0.6176430775135439,
            0.6177706921748373,
            0.617973222325554,
            0.6179053924390712,
            0.6179239183384262,
            0.6180160311766529,
            0.6179732961339179,
            0.6179386062028549
          ],
          "learning_rate": [
            0.000992403876506103,
            0.0009698463103929538,
            0.0009330127018922194,
            0.0008830222215594889,
            0.0008213938048432717,
            0.0007500000000000018,
            0.0006710100716628345,
            0.0005868240888334639,
            0.0004999999999999986,
            0.00041317591116653323,
            0.0003289899283371649,
            0.0002499999999999986,
            0.0001786061951567293,
            0.00011697777844051034,
            6.698729810778051e-05,
            3.0153689607045717e-05,
            7.596123493895977e-06,
            0.0,
            7.596123493895969e-06,
            3.015368960704586e-05
          ]
        },
        "final_metrics": {
          "loss": 0.6405932307243347,
          "accuracy": 0.4098173515981735,
          "precision": 0.2008838891120932,
          "recall": 0.8635578583765112,
          "f1": 0.3259452411994785,
          "auroc": 0.6179386062028549
        },
        "best_val_f1": 0.32779097387173395,
        "training_time": 201.9352514743805,
        "num_parameters": 4097
      },
      "paths": {
        "probe": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_0.pt",
        "config": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_0_config.json",
        "metrics": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_0_metrics.json",
        "log": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_0_training.log",
        "checkpoints": "ntml_4T1L_500samples/checkpoints"
      }
    },
    "1": {
      "config": {
        "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
        "max_length": 512,
        "model_name": "meta-llama/Llama-3.1-8B-Instruct",
        "hook_point": "blocks.1.hook_resid_pre",
        "hook_layer": 1,
        "device": "cuda",
        "dtype": "bfloat16",
        "batch_size": 32,
        "learning_rate": 0.001,
        "num_epochs": 20,
        "weight_decay": 0.01,
        "train_ratio": 0.8,
        "handle_class_imbalance": true,
        "optimizer_type": "AdamW",
        "scheduler_type": "cosine",
        "warmup_ratio": 0.1,
        "gradient_clip_norm": 1.0,
        "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
        "activation_batch_size": 16,
        "force_recache": false,
        "output_dir": "./ntml_4T1L_500samples",
        "probe_name": "ntml_binary_4T1L_500samples_layer_1",
        "save_checkpoints": true,
        "checkpoint_every": 5,
        "verbose": true,
        "log_every": 10,
        "eval_every": 1,
        "ignore_system_tokens": true,
        "ignore_user_tokens": true,
        "min_tokens_per_statement": 1,
        "token_overlap_strategy": "majority"
      },
      "training_results": {
        "training_history": {
          "train_loss": [
            1.0845212317901114,
            1.0426810378353346,
            1.0294853092328597,
            1.0213002547553685,
            1.0151022168803432,
            1.0097930156476966,
            1.0057894233699258,
            1.0023131818940105,
            0.99945581068187,
            0.9975382033820566,
            0.9960490447473308,
            0.993251980439713,
            0.9917817084484448,
            0.9915898457237574,
            0.9901976380582269,
            0.9902127117054648,
            0.9890958530717788,
            0.9898212554111873,
            0.9899176506146993,
            0.9906000001653689
          ],
          "train_accuracy": [
            0.40146271851587584,
            0.3925793792365323,
            0.41812343917231537,
            0.4301462718515876,
            0.4487334998216197,
            0.4596146985372815,
            0.4618622904031395,
            0.47898679985729575,
            0.48230467356403856,
            0.48622904031394937,
            0.49054584373885124,
            0.4899393506956832,
            0.49122368890474494,
            0.49721726721369963,
            0.5002497324295397,
            0.49960756332500894,
            0.5017838030681413,
            0.5000713521227257,
            0.49843025330003565,
            0.5001783803068142
          ],
          "val_loss": [
            0.6537109792232514,
            0.6545500549403104,
            0.6583523051305251,
            0.6527980045838789,
            0.6502360154281963,
            0.6472340188243172,
            0.6348920860073783,
            0.6398502447388389,
            0.6422106325626373,
            0.637419074231928,
            0.644311558116566,
            0.6406688104976307,
            0.6349317361008037,
            0.6378275242718783,
            0.6377015005458485,
            0.6376461668448015,
            0.6377138446677815,
            0.6377376128326763,
            0.6377811404791746,
            0.6376963209022175
          ],
          "val_accuracy": [
            0.3617294520547945,
            0.3690068493150685,
            0.3771404109589041,
            0.3971175799086758,
            0.4092465753424658,
            0.4195205479452055,
            0.4484874429223744,
            0.4402111872146119,
            0.4360730593607306,
            0.4479166666666667,
            0.4345034246575342,
            0.4444920091324201,
            0.4540525114155251,
            0.4486301369863014,
            0.4492009132420091,
            0.4492009132420091,
            0.4490582191780822,
            0.4492009132420091,
            0.4490582191780822,
            0.4493436073059361
          ],
          "val_f1": [
            0.3292847503373819,
            0.327350167325829,
            0.32524346885144534,
            0.32561851556264965,
            0.32463295269168024,
            0.3253731343283582,
            0.32630294579048286,
            0.3249010497332645,
            0.32490604714724974,
            0.32513518227803945,
            0.32314261315115284,
            0.3237797463956922,
            0.3259337561663143,
            0.32447552447552447,
            0.3242296918767507,
            0.3239929947460595,
            0.32417293891125504,
            0.3242296918767507,
            0.32417293891125504,
            0.3242864647172124
          ],
          "val_auroc": [
            0.6082998573297655,
            0.6097760157675082,
            0.6135301495882434,
            0.6143364957472874,
            0.6164296499867411,
            0.6144218202910239,
            0.6166192194995803,
            0.6176999483523524,
            0.6181720093126479,
            0.6186000930680383,
            0.6186534209078736,
            0.6189332094374205,
            0.619076464086622,
            0.6191351247104409,
            0.6193057007460785,
            0.6192796942926793,
            0.6193105952190496,
            0.6193035822428521,
            0.6193403273160537,
            0.6192975189405148
          ],
          "learning_rate": [
            0.000992403876506103,
            0.0009698463103929538,
            0.0009330127018922194,
            0.0008830222215594889,
            0.0008213938048432717,
            0.0007500000000000018,
            0.0006710100716628345,
            0.0005868240888334639,
            0.0004999999999999986,
            0.00041317591116653323,
            0.0003289899283371649,
            0.0002499999999999986,
            0.0001786061951567293,
            0.00011697777844051034,
            6.698729810778051e-05,
            3.0153689607045717e-05,
            7.596123493895977e-06,
            0.0,
            7.596123493895969e-06,
            3.015368960704586e-05
          ]
        },
        "final_metrics": {
          "loss": 0.6376963209022175,
          "accuracy": 0.4493436073059361,
          "precision": 0.20405464962538564,
          "recall": 0.7894288150042625,
          "f1": 0.3242864647172124,
          "auroc": 0.6192975189405148
        },
        "best_val_f1": 0.3292847503373819,
        "training_time": 199.53048133850098,
        "num_parameters": 4097
      },
      "paths": {
        "probe": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_1.pt",
        "config": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_1_config.json",
        "metrics": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_1_metrics.json",
        "log": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_1_training.log",
        "checkpoints": "ntml_4T1L_500samples/checkpoints"
      }
    },
    "2": {
      "config": {
        "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
        "max_length": 512,
        "model_name": "meta-llama/Llama-3.1-8B-Instruct",
        "hook_point": "blocks.2.hook_resid_pre",
        "hook_layer": 2,
        "device": "cuda",
        "dtype": "bfloat16",
        "batch_size": 32,
        "learning_rate": 0.001,
        "num_epochs": 20,
        "weight_decay": 0.01,
        "train_ratio": 0.8,
        "handle_class_imbalance": true,
        "optimizer_type": "AdamW",
        "scheduler_type": "cosine",
        "warmup_ratio": 0.1,
        "gradient_clip_norm": 1.0,
        "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
        "activation_batch_size": 16,
        "force_recache": false,
        "output_dir": "./ntml_4T1L_500samples",
        "probe_name": "ntml_binary_4T1L_500samples_layer_2",
        "save_checkpoints": true,
        "checkpoint_every": 5,
        "verbose": true,
        "log_every": 10,
        "eval_every": 1,
        "ignore_system_tokens": true,
        "ignore_user_tokens": true,
        "min_tokens_per_statement": 1,
        "token_overlap_strategy": "majority"
      },
      "training_results": {
        "training_history": {
          "train_loss": [
            1.0699125013939321,
            1.028334890122283,
            1.0137716652868,
            1.0031505039973891,
            0.9951291778996655,
            0.9884831158946094,
            0.9839550266254983,
            0.9799397957243331,
            0.9756739053824176,
            0.9718569235442436,
            0.9691465294252247,
            0.9674620215343014,
            0.9652649061456663,
            0.9633964106576628,
            0.9633985016171791,
            0.9631097368453736,
            0.9604783882153088,
            0.9626639640494569,
            0.9618676469478433,
            0.9618971483212083
          ],
          "train_accuracy": [
            0.41262932572244027,
            0.4401712450945416,
            0.46803424901890833,
            0.4861933642525865,
            0.5087406350338922,
            0.519229397074563,
            0.5360684980378166,
            0.5326792722083482,
            0.5468069925080271,
            0.5518016410988227,
            0.556831965750981,
            0.5618979664645023,
            0.5579022475918659,
            0.5635390652871923,
            0.5668569389939351,
            0.5643239386371744,
            0.5678558687120941,
            0.5641098822689975,
            0.564823403496254,
            0.5642525865144488
          ],
          "val_loss": [
            0.637160753661936,
            0.6384451774033633,
            0.634378498250788,
            0.6225652981888165,
            0.6224038741805337,
            0.6021014961329374,
            0.6310418833385815,
            0.6138049737973647,
            0.6170518387447704,
            0.6156180696053939,
            0.6216483647173101,
            0.6227029496973211,
            0.6144110387021845,
            0.6126950990069996,
            0.613146406953985,
            0.6139652880755337,
            0.6139270424842834,
            0.614051015810533,
            0.6142057044939562,
            0.6139741854234175
          ],
          "val_accuracy": [
            0.4293664383561644,
            0.4202340182648402,
            0.4427796803652968,
            0.4860159817351598,
            0.4910102739726027,
            0.5490867579908676,
            0.478453196347032,
            0.5235445205479452,
            0.5186929223744292,
            0.523972602739726,
            0.511843607305936,
            0.5107020547945206,
            0.5299657534246576,
            0.5349600456621004,
            0.5332477168949772,
            0.5319634703196348,
            0.5321061643835616,
            0.5316780821917808,
            0.531107305936073,
            0.5319634703196348
          ],
          "val_f1": [
            0.34064303380049465,
            0.3452054794520548,
            0.3468807492891788,
            0.35052289938694553,
            0.3515724413742956,
            0.34952655413750516,
            0.35091458000355175,
            0.3550318717403902,
            0.35543665201605196,
            0.35573580533024335,
            0.35562252778300996,
            0.3546019198193111,
            0.3573936792820913,
            0.3583382555621185,
            0.35749361618542524,
            0.3576184880532707,
            0.3574368018812463,
            0.3572267920094007,
            0.3574501368791553,
            0.3576184880532707
          ],
          "val_auroc": [
            0.6265306828247468,
            0.6438493543708336,
            0.6499979884743107,
            0.6541082059661147,
            0.6565682665942045,
            0.6597543115465103,
            0.6602980587012601,
            0.6618927398038585,
            0.6629667533622475,
            0.6631695292676987,
            0.6636940787035894,
            0.6643182163060625,
            0.6645850787141763,
            0.6647638574710535,
            0.6648664805711322,
            0.6649224503911888,
            0.6649014175962621,
            0.6649021939745983,
            0.6649307082334923,
            0.6649840665991453
          ],
          "learning_rate": [
            0.000992403876506103,
            0.0009698463103929538,
            0.0009330127018922194,
            0.0008830222215594889,
            0.0008213938048432717,
            0.0007500000000000018,
            0.0006710100716628345,
            0.0005868240888334639,
            0.0004999999999999986,
            0.00041317591116653323,
            0.0003289899283371649,
            0.0002499999999999986,
            0.0001786061951567293,
            0.00011697777844051034,
            6.698729810778051e-05,
            3.0153689607045717e-05,
            7.596123493895977e-06,
            0.0,
            7.596123493895969e-06,
            3.015368960704586e-05
          ]
        },
        "final_metrics": {
          "loss": 0.6139741854234175,
          "accuracy": 0.5319634703196348,
          "precision": 0.2352486472558619,
          "recall": 0.7453061224489796,
          "f1": 0.3576184880532707,
          "auroc": 0.6649840665991453
        },
        "best_val_f1": 0.3583382555621185,
        "training_time": 198.90825486183167,
        "num_parameters": 4097
      },
      "paths": {
        "probe": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_2.pt",
        "config": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_2_config.json",
        "metrics": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_2_metrics.json",
        "log": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_2_training.log",
        "checkpoints": "ntml_4T1L_500samples/checkpoints"
      }
    },
    "3": {
      "config": {
        "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
        "max_length": 512,
        "model_name": "meta-llama/Llama-3.1-8B-Instruct",
        "hook_point": "blocks.3.hook_resid_pre",
        "hook_layer": 3,
        "device": "cuda",
        "dtype": "bfloat16",
        "batch_size": 32,
        "learning_rate": 0.001,
        "num_epochs": 20,
        "weight_decay": 0.01,
        "train_ratio": 0.8,
        "handle_class_imbalance": true,
        "optimizer_type": "AdamW",
        "scheduler_type": "cosine",
        "warmup_ratio": 0.1,
        "gradient_clip_norm": 1.0,
        "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
        "activation_batch_size": 16,
        "force_recache": false,
        "output_dir": "./ntml_4T1L_500samples",
        "probe_name": "ntml_binary_4T1L_500samples_layer_3",
        "save_checkpoints": true,
        "checkpoint_every": 5,
        "verbose": true,
        "log_every": 10,
        "eval_every": 1,
        "ignore_system_tokens": true,
        "ignore_user_tokens": true,
        "min_tokens_per_statement": 1,
        "token_overlap_strategy": "majority"
      },
      "training_results": {
        "training_history": {
          "train_loss": [
            1.0563687126930446,
            1.016694652435442,
            1.0008462062573324,
            0.9887671862563042,
            0.9788388123387071,
            0.9706141463561689,
            0.9656641535699095,
            0.9600454325273157,
            0.9555045843260473,
            0.9510646490337642,
            0.9487109004634701,
            0.9454957881610687,
            0.9431260538427797,
            0.9401565294151437,
            0.9400109442537778,
            0.9400803414790053,
            0.9389118117420641,
            0.9386277245400159,
            0.9394856187850917,
            0.9385773591254944
          ],
          "train_accuracy": [
            0.413699607563325,
            0.46361041740991793,
            0.5114163396361042,
            0.5328219764537995,
            0.5504816268283982,
            0.5683910096325365,
            0.5696396717802354,
            0.5841241526935427,
            0.5879058151980021,
            0.595718872636461,
            0.5981091687477702,
            0.5997145915090974,
            0.6062076346771317,
            0.5968961826614342,
            0.6088833392793436,
            0.6140920442383161,
            0.6083481983589012,
            0.6060649304316803,
            0.6049946485907955,
            0.6104530859793079
          ],
          "val_loss": [
            0.6239574952559037,
            0.6328789342533458,
            0.6066299525174228,
            0.5998280297626148,
            0.608044771714644,
            0.6190105519511483,
            0.5963241848078641,
            0.6114986972375349,
            0.6036028764464638,
            0.6042046736587178,
            0.6013998746871948,
            0.5991634515198794,
            0.6043270436200229,
            0.5948293523354964,
            0.5974753206426447,
            0.5991180950945074,
            0.6005265940319408,
            0.6011285126209259,
            0.6010497851805253,
            0.6012033489617434
          ],
          "val_accuracy": [
            0.447060502283105,
            0.4579052511415525,
            0.5351027397260274,
            0.5490867579908676,
            0.5392408675799086,
            0.5185502283105022,
            0.567208904109589,
            0.5412385844748858,
            0.557505707762557,
            0.5557933789954338,
            0.5625,
            0.5653538812785388,
            0.5543664383561644,
            0.5737728310502284,
            0.56949200913242,
            0.5654965753424658,
            0.5627853881278538,
            0.5619292237442922,
            0.5620719178082192,
            0.5617865296803652
          ],
          "val_f1": [
            0.353628023352794,
            0.35621081172682595,
            0.3528009535160906,
            0.3566775244299674,
            0.3589438157633512,
            0.3629154078549849,
            0.35755136623596695,
            0.36197658265528876,
            0.36180284009055363,
            0.36378499897813205,
            0.36469125569830085,
            0.3630280217482225,
            0.36304303487660616,
            0.361615729856807,
            0.36336779911373707,
            0.3633702697052059,
            0.3632585203657523,
            0.3633347158855247,
            0.3634100808960797,
            0.36352331606217614
          ],
          "val_auroc": [
            0.6552341951244739,
            0.6614594341340791,
            0.6679099391346188,
            0.6725551543332015,
            0.6772931178499478,
            0.6800247666115049,
            0.6801906596260388,
            0.6808446757968485,
            0.6829149306804692,
            0.6825492774624959,
            0.6839984699338058,
            0.6838383385572184,
            0.6844322791128539,
            0.6845503224268806,
            0.6845317024993705,
            0.6846191107628521,
            0.6846446165503471,
            0.6846622527835737,
            0.6846964010279887,
            0.6846513618825772
          ],
          "learning_rate": [
            0.000992403876506103,
            0.0009698463103929538,
            0.0009330127018922194,
            0.0008830222215594889,
            0.0008213938048432717,
            0.0007500000000000018,
            0.0006710100716628345,
            0.0005868240888334639,
            0.0004999999999999986,
            0.00041317591116653323,
            0.0003289899283371649,
            0.0002499999999999986,
            0.0001786061951567293,
            0.00011697777844051034,
            6.698729810778051e-05,
            3.0153689607045717e-05,
            7.596123493895977e-06,
            0.0,
            7.596123493895969e-06,
            3.015368960704586e-05
          ]
        },
        "final_metrics": {
          "loss": 0.6012033489617434,
          "accuracy": 0.5617865296803652,
          "precision": 0.24408572223768438,
          "recall": 0.7118506493506493,
          "f1": 0.36352331606217614,
          "auroc": 0.6846513618825772
        },
        "best_val_f1": 0.36469125569830085,
        "training_time": 199.32722544670105,
        "num_parameters": 4097
      },
      "paths": {
        "probe": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_3.pt",
        "config": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_3_config.json",
        "metrics": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_3_metrics.json",
        "log": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_3_training.log",
        "checkpoints": "ntml_4T1L_500samples/checkpoints"
      }
    },
    "4": {
      "config": {
        "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
        "max_length": 512,
        "model_name": "meta-llama/Llama-3.1-8B-Instruct",
        "hook_point": "blocks.4.hook_resid_pre",
        "hook_layer": 4,
        "device": "cuda",
        "dtype": "bfloat16",
        "batch_size": 32,
        "learning_rate": 0.001,
        "num_epochs": 20,
        "weight_decay": 0.01,
        "train_ratio": 0.8,
        "handle_class_imbalance": true,
        "optimizer_type": "AdamW",
        "scheduler_type": "cosine",
        "warmup_ratio": 0.1,
        "gradient_clip_norm": 1.0,
        "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
        "activation_batch_size": 16,
        "force_recache": false,
        "output_dir": "./ntml_4T1L_500samples",
        "probe_name": "ntml_binary_4T1L_500samples_layer_4",
        "save_checkpoints": true,
        "checkpoint_every": 5,
        "verbose": true,
        "log_every": 10,
        "eval_every": 1,
        "ignore_system_tokens": true,
        "ignore_user_tokens": true,
        "min_tokens_per_statement": 1,
        "token_overlap_strategy": "majority"
      },
      "training_results": {
        "training_history": {
          "train_loss": [
            1.0479495463442041,
            1.0016238503668407,
            0.9805268618069827,
            0.9643023504650212,
            0.9533723352570512,
            0.9426520799529062,
            0.9335504728773413,
            0.9252291418373857,
            0.9220040133010307,
            0.9174299172070473,
            0.9123558520114041,
            0.9090204007209164,
            0.9081206619059115,
            0.9046433571402885,
            0.9031506900645826,
            0.9032588524225096,
            0.8998637816881481,
            0.9024136540007918,
            0.9001923978464789,
            0.9017642057377454
          ],
          "train_accuracy": [
            0.4385301462718516,
            0.509418480199786,
            0.5497324295397789,
            0.5770246164823404,
            0.5920799143774528,
            0.6109525508383874,
            0.6150196218337496,
            0.6265073135925794,
            0.6347841598287549,
            0.6339279343560471,
            0.6426328933285765,
            0.6431680342490189,
            0.643952907599001,
            0.6472707813057439,
            0.6538708526578666,
            0.6457367106671423,
            0.6444166963967178,
            0.650517302889761,
            0.6514448804851944,
            0.6499464859079558
          ],
          "val_loss": [
            0.6183334675702181,
            0.6451444604180075,
            0.635990537296642,
            0.6329034946181558,
            0.6105431350794706,
            0.6366618205200542,
            0.6004476260055195,
            0.5858125507831573,
            0.5973856056278403,
            0.5955436752601103,
            0.5922321671789342,
            0.5888396794145757,
            0.5954235832799565,
            0.5889008947394111,
            0.5967420987107537,
            0.5959316470406272,
            0.5950727581977844,
            0.5941664397716522,
            0.5941429745067249,
            0.5940774064172398
          ],
          "val_accuracy": [
            0.5055650684931506,
            0.4643264840182648,
            0.4911529680365297,
            0.5159817351598174,
            0.5625,
            0.5201198630136986,
            0.5851883561643836,
            0.6164383561643836,
            0.5943207762557078,
            0.5950342465753424,
            0.6037385844748858,
            0.6075913242009132,
            0.5974600456621004,
            0.6085901826484018,
            0.5946061643835616,
            0.596175799086758,
            0.5977454337899544,
            0.6000285388127854,
            0.6003139269406392,
            0.5997431506849316
          ],
          "val_f1": [
            0.3488066152978763,
            0.3563100137174211,
            0.3597845601436266,
            0.3662182361733931,
            0.36809563066776585,
            0.3691615081598199,
            0.3725447873947766,
            0.37371854613233924,
            0.37420206911732334,
            0.37350993377483444,
            0.3769351581781467,
            0.3752839618355293,
            0.37685001104484206,
            0.3775811209439528,
            0.3754671356342053,
            0.37527593818984545,
            0.37563676633444076,
            0.3764182424916574,
            0.37658580013354104,
            0.3759733036707453
          ],
          "val_auroc": [
            0.6624237264648153,
            0.6779390442125255,
            0.6862695000136304,
            0.6920076920979936,
            0.6984892387867112,
            0.6998730099592905,
            0.7019909778005962,
            0.7040065755397644,
            0.706048156259087,
            0.7061694811582219,
            0.7084140982798415,
            0.7077791480762939,
            0.7084323431593487,
            0.7087067972611951,
            0.7084241081164582,
            0.7085704931030097,
            0.7086079767465105,
            0.7086698105599375,
            0.7086692426259451,
            0.7085895898835055
          ],
          "learning_rate": [
            0.000992403876506103,
            0.0009698463103929538,
            0.0009330127018922194,
            0.0008830222215594889,
            0.0008213938048432717,
            0.0007500000000000018,
            0.0006710100716628345,
            0.0005868240888334639,
            0.0004999999999999986,
            0.00041317591116653323,
            0.0003289899283371649,
            0.0002499999999999986,
            0.0001786061951567293,
            0.00011697777844051034,
            6.698729810778051e-05,
            3.0153689607045717e-05,
            7.596123493895977e-06,
            0.0,
            7.596123493895969e-06,
            3.015368960704586e-05
          ]
        },
        "final_metrics": {
          "loss": 0.5940774064172398,
          "accuracy": 0.5997431506849316,
          "precision": 0.25770051845074715,
          "recall": 0.6949013157894737,
          "f1": 0.3759733036707453,
          "auroc": 0.7085895898835055
        },
        "best_val_f1": 0.3775811209439528,
        "training_time": 202.63755869865417,
        "num_parameters": 4097
      },
      "paths": {
        "probe": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_4.pt",
        "config": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_4_config.json",
        "metrics": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_4_metrics.json",
        "log": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_4_training.log",
        "checkpoints": "ntml_4T1L_500samples/checkpoints"
      }
    },
    "5": {
      "config": {
        "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
        "max_length": 512,
        "model_name": "meta-llama/Llama-3.1-8B-Instruct",
        "hook_point": "blocks.5.hook_resid_pre",
        "hook_layer": 5,
        "device": "cuda",
        "dtype": "bfloat16",
        "batch_size": 32,
        "learning_rate": 0.001,
        "num_epochs": 20,
        "weight_decay": 0.01,
        "train_ratio": 0.8,
        "handle_class_imbalance": true,
        "optimizer_type": "AdamW",
        "scheduler_type": "cosine",
        "warmup_ratio": 0.1,
        "gradient_clip_norm": 1.0,
        "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
        "activation_batch_size": 16,
        "force_recache": false,
        "output_dir": "./ntml_4T1L_500samples",
        "probe_name": "ntml_binary_4T1L_500samples_layer_5",
        "save_checkpoints": true,
        "checkpoint_every": 5,
        "verbose": true,
        "log_every": 10,
        "eval_every": 1,
        "ignore_system_tokens": true,
        "ignore_user_tokens": true,
        "min_tokens_per_statement": 1,
        "token_overlap_strategy": "majority"
      },
      "training_results": {
        "training_history": {
          "train_loss": [
            1.0347026451809767,
            0.9833259898233632,
            0.9584110610561284,
            0.940949764868168,
            0.927796361585186,
            0.915324002368265,
            0.9068939212930801,
            0.8975605620028766,
            0.8911772855476702,
            0.8859947342170428,
            0.8826883827850699,
            0.8795432362994647,
            0.8750393340304562,
            0.871874527776078,
            0.8713753201986012,
            0.8709637636667518,
            0.8687995236418019,
            0.8709262673100925,
            0.8701554881451337,
            0.8682456679948388
          ],
          "train_accuracy": [
            0.48847663217980736,
            0.5636460934712808,
            0.604709240099893,
            0.6252229753835177,
            0.63863717445594,
            0.6528362468783446,
            0.6583303603282198,
            0.6667855868712094,
            0.671994291830182,
            0.6759186585800928,
            0.6794149125936496,
            0.6836246878344631,
            0.6833749554049233,
            0.6900820549411345,
            0.6834819835890118,
            0.6892258294684267,
            0.6890117731002497,
            0.6899393506956832,
            0.6900463788797717,
            0.6902247591865858
          ],
          "val_loss": [
            0.6163200936534188,
            0.6096874426711689,
            0.6217730072411624,
            0.5970530173995278,
            0.5983656693588604,
            0.5968996001915499,
            0.5918166025118394,
            0.5700549038973721,
            0.5839542150497437,
            0.5751266157085245,
            0.5722121926871213,
            0.5693967770446431,
            0.5595391235568307,
            0.5769285795363512,
            0.5713335901498795,
            0.5718016001311216,
            0.5719387669454922,
            0.5718524567105553,
            0.5714036424051632,
            0.5710461990399794
          ],
          "val_accuracy": [
            0.5272545662100456,
            0.5627853881278538,
            0.5459474885844748,
            0.5993150684931506,
            0.6005993150684932,
            0.6060216894977168,
            0.6191495433789954,
            0.653681506849315,
            0.6278538812785388,
            0.6454052511415526,
            0.6494006849315068,
            0.6541095890410958,
            0.6662385844748858,
            0.6408390410958904,
            0.6505422374429224,
            0.6496860730593608,
            0.64925799086758,
            0.6496860730593608,
            0.6502568493150684,
            0.6502568493150684
          ],
          "val_f1": [
            0.358567279767667,
            0.3669421487603306,
            0.3738685556867375,
            0.3790358248562583,
            0.3811629449480433,
            0.3914480934538241,
            0.3940976163450624,
            0.38912660458092124,
            0.3976905311778291,
            0.40307470574105214,
            0.40175310445580714,
            0.40177690029615004,
            0.4001025904077969,
            0.40256349394730595,
            0.4037009982955929,
            0.40398154891964067,
            0.4036875303250849,
            0.4036920087442312,
            0.40379469715397714,
            0.40321402483564645
          ],
          "val_auroc": [
            0.6746359058311713,
            0.6914149682214191,
            0.7024987396195634,
            0.7068529999886708,
            0.7114232952292476,
            0.716216918553933,
            0.7185974798055899,
            0.7196846641440175,
            0.7225900534741183,
            0.7241044926189856,
            0.724552423329217,
            0.7248541357472216,
            0.725879858837391,
            0.7259697848573079,
            0.726271355659533,
            0.7263693537788756,
            0.7264577928331086,
            0.7264551021333001,
            0.7264643779668506,
            0.7265131646028526
          ],
          "learning_rate": [
            0.000992403876506103,
            0.0009698463103929538,
            0.0009330127018922194,
            0.0008830222215594889,
            0.0008213938048432717,
            0.0007500000000000018,
            0.0006710100716628345,
            0.0005868240888334639,
            0.0004999999999999986,
            0.00041317591116653323,
            0.0003289899283371649,
            0.0002499999999999986,
            0.0001786061951567293,
            0.00011697777844051034,
            6.698729810778051e-05,
            3.0153689607045717e-05,
            7.596123493895977e-06,
            0.0,
            7.596123493895969e-06,
            3.015368960704586e-05
          ]
        },
        "final_metrics": {
          "loss": 0.5710461990399794,
          "accuracy": 0.6502568493150684,
          "precision": 0.28680290959473503,
          "recall": 0.6786885245901639,
          "f1": 0.40321402483564645,
          "auroc": 0.7265131646028526
        },
        "best_val_f1": 0.40398154891964067,
        "training_time": 201.9266495704651,
        "num_parameters": 4097
      },
      "paths": {
        "probe": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_5.pt",
        "config": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_5_config.json",
        "metrics": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_5_metrics.json",
        "log": "ntml_4T1L_500samples/ntml_binary_4T1L_500samples_layer_5_training.log",
        "checkpoints": "ntml_4T1L_500samples/checkpoints"
      }
    }
  }
}