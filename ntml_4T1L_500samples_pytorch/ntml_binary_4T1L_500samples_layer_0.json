{
  "model_type": "pytorch_interpretability_probe",
  "training_history": {
    "train_loss": [
      0.503878672509433,
      0.46282740672157235,
      0.4581912779780828,
      0.45627683179971834,
      0.4556047007373479,
      0.45491108890265636,
      0.4546701660779513,
      0.4542311832785062,
      0.45385712582498927,
      0.45370191117944236,
      0.45352906179210367,
      0.45332954442936535,
      0.45327363850455304,
      0.45323951294024784,
      0.45325035435151834,
      0.45325157597456894,
      0.4532453447036003,
      0.4531860990475302,
      0.4532324049502747,
      0.45321576542233766
    ],
    "train_accuracy": [
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206,
      0.8282911166607206
    ],
    "val_loss": [
      0.4667576182972301,
      0.4599068381569602,
      0.45733788230202416,
      0.4567687294699929,
      0.45603013472123577,
      0.45574368563565343,
      0.455754921653054,
      0.45513153076171875,
      0.45502430308948866,
      0.454969648881392,
      0.45465323708274147,
      0.45463464910333806,
      0.45467903830788353,
      0.45466031161221593,
      0.4546232743696733,
      0.45467376708984375,
      0.4546410300514915,
      0.45466156005859376,
      0.45464047518643463,
      0.45465878573330964
    ],
    "val_accuracy": [
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748,
      0.8271974885844748
    ],
    "val_f1": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "val_auroc": [
      0.6107069817569868,
      0.6138347563526623,
      0.6172919390664069,
      0.6177444211797242,
      0.618605939146462,
      0.6185218955617438,
      0.6186060103698389,
      0.6188813599448559,
      0.6189891921374521,
      0.6192041442888752,
      0.6194004359155559,
      0.6194997925263032,
      0.619427002235132,
      0.6195623266512036,
      0.6198197279352471,
      0.6196486493839819,
      0.6199560494785951,
      0.6198462230314464,
      0.6198393855872659,
      0.6198796980185799
    ],
    "learning_rate": [
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.0.hook_resid_pre",
      "hook_layer": 0,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.001,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples_pytorch",
      "probe_name": "ntml_binary_4T1L_500samples_layer_0",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority",
      "probe_method": "pytorch",
      "sklearn_C": 1.0,
      "sklearn_C_sweep": false,
      "sklearn_C_values": [
        0.0001,
        0.001,
        0.01,
        0.1,
        1.0,
        10.0,
        100.0,
        1000.0,
        10000.0
      ],
      "sklearn_solver": "liblinear",
      "sklearn_max_iter": 1000,
      "pytorch_bias": true,
      "pytorch_normalize_weights": true
    },
    "training_history": {
      "train_loss": [
        0.503878672509433,
        0.46282740672157235,
        0.4581912779780828,
        0.45627683179971834,
        0.4556047007373479,
        0.45491108890265636,
        0.4546701660779513,
        0.4542311832785062,
        0.45385712582498927,
        0.45370191117944236,
        0.45352906179210367,
        0.45332954442936535,
        0.45327363850455304,
        0.45323951294024784,
        0.45325035435151834,
        0.45325157597456894,
        0.4532453447036003,
        0.4531860990475302,
        0.4532324049502747,
        0.45321576542233766
      ],
      "train_accuracy": [
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206,
        0.8282911166607206
      ],
      "val_loss": [
        0.4667576182972301,
        0.4599068381569602,
        0.45733788230202416,
        0.4567687294699929,
        0.45603013472123577,
        0.45574368563565343,
        0.455754921653054,
        0.45513153076171875,
        0.45502430308948866,
        0.454969648881392,
        0.45465323708274147,
        0.45463464910333806,
        0.45467903830788353,
        0.45466031161221593,
        0.4546232743696733,
        0.45467376708984375,
        0.4546410300514915,
        0.45466156005859376,
        0.45464047518643463,
        0.45465878573330964
      ],
      "val_accuracy": [
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748,
        0.8271974885844748
      ],
      "val_f1": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      "val_auroc": [
        0.6107069817569868,
        0.6138347563526623,
        0.6172919390664069,
        0.6177444211797242,
        0.618605939146462,
        0.6185218955617438,
        0.6186060103698389,
        0.6188813599448559,
        0.6189891921374521,
        0.6192041442888752,
        0.6194004359155559,
        0.6194997925263032,
        0.619427002235132,
        0.6195623266512036,
        0.6198197279352471,
        0.6196486493839819,
        0.6199560494785951,
        0.6198462230314464,
        0.6198393855872659,
        0.6198796980185799
      ],
      "learning_rate": [
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001
      ]
    },
    "final_metrics": {
      "loss": 0.45465878573330964,
      "accuracy": 0.8271974885844748,
      "precision": 0.0,
      "recall": 0.0,
      "f1": 0.0,
      "auroc": 0.6198796980185799
    },
    "best_val_f1": 0.0,
    "training_time": 28.207372665405273,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.0.hook_resid_pre",
    "hook_layer": 0,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.001,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples_pytorch",
    "probe_name": "ntml_binary_4T1L_500samples_layer_0",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority",
    "probe_method": "pytorch",
    "sklearn_C": 1.0,
    "sklearn_C_sweep": false,
    "sklearn_C_values": [
      0.0001,
      0.001,
      0.01,
      0.1,
      1.0,
      10.0,
      100.0,
      1000.0,
      10000.0
    ],
    "sklearn_solver": "liblinear",
    "sklearn_max_iter": 1000,
    "pytorch_bias": true,
    "pytorch_normalize_weights": true
  }
}