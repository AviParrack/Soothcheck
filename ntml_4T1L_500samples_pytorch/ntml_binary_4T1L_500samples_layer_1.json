{
  "model_type": "pytorch_interpretability_probe",
  "training_history": {
    "train_loss": [
      0.46855283576195644,
      0.4377766224687502,
      0.43407765976642365,
      0.43187217251078724,
      0.43089540503476853,
      0.43031527551069654,
      0.42958864766985316,
      0.42919268850322184,
      0.4289433576813027,
      0.4287056567394026,
      0.42839077060625436,
      0.42826180425408766,
      0.4281203155512135,
      0.4280027450832058,
      0.4279559113799709,
      0.42786687796246514,
      0.4278138838878505,
      0.42777231124710274,
      0.4276797557802505,
      0.4276346273754285
    ],
    "train_accuracy": [
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783,
      0.8277559757402783
    ],
    "val_loss": [
      0.43828159679066053,
      0.43334763266823506,
      0.4313382582231001,
      0.4303973458030007,
      0.43004774613813923,
      0.42982118779962714,
      0.42933429371226917,
      0.4292062932794744,
      0.4290620283647017,
      0.42882510098544036,
      0.42881046641956677,
      0.4287362878972834,
      0.428724531693892,
      0.42871239402077416,
      0.4286572889848189,
      0.42862930297851565,
      0.42859892411665484,
      0.42856563221324573,
      0.4285972942005504,
      0.42860034595836294
    ],
    "val_accuracy": [
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379,
      0.829337899543379
    ],
    "val_f1": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "val_auroc": [
      0.6045774139308131,
      0.6214359864379314,
      0.6272030161331532,
      0.6294540818557844,
      0.6308885203488572,
      0.6311438017755906,
      0.6317973625091209,
      0.6327408751815526,
      0.6328305006134234,
      0.6326748429612818,
      0.6329181119906455,
      0.6332704276931364,
      0.6331072173360617,
      0.633292150711134,
      0.633288410323929,
      0.633678705342654,
      0.6340199437445765,
      0.6341226605316643,
      0.6336382084581088,
      0.6338474543500128
    ],
    "learning_rate": [
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.1.hook_resid_pre",
      "hook_layer": 1,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.001,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples_pytorch",
      "probe_name": "ntml_binary_4T1L_500samples_layer_1",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority",
      "probe_method": "pytorch",
      "sklearn_C": 1.0,
      "sklearn_C_sweep": false,
      "sklearn_C_values": [
        0.0001,
        0.001,
        0.01,
        0.1,
        1.0,
        10.0,
        100.0,
        1000.0,
        10000.0
      ],
      "sklearn_solver": "liblinear",
      "sklearn_max_iter": 1000,
      "pytorch_bias": true,
      "pytorch_normalize_weights": true
    },
    "training_history": {
      "train_loss": [
        0.46855283576195644,
        0.4377766224687502,
        0.43407765976642365,
        0.43187217251078724,
        0.43089540503476853,
        0.43031527551069654,
        0.42958864766985316,
        0.42919268850322184,
        0.4289433576813027,
        0.4287056567394026,
        0.42839077060625436,
        0.42826180425408766,
        0.4281203155512135,
        0.4280027450832058,
        0.4279559113799709,
        0.42786687796246514,
        0.4278138838878505,
        0.42777231124710274,
        0.4276797557802505,
        0.4276346273754285
      ],
      "train_accuracy": [
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783,
        0.8277559757402783
      ],
      "val_loss": [
        0.43828159679066053,
        0.43334763266823506,
        0.4313382582231001,
        0.4303973458030007,
        0.43004774613813923,
        0.42982118779962714,
        0.42933429371226917,
        0.4292062932794744,
        0.4290620283647017,
        0.42882510098544036,
        0.42881046641956677,
        0.4287362878972834,
        0.428724531693892,
        0.42871239402077416,
        0.4286572889848189,
        0.42862930297851565,
        0.42859892411665484,
        0.42856563221324573,
        0.4285972942005504,
        0.42860034595836294
      ],
      "val_accuracy": [
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379,
        0.829337899543379
      ],
      "val_f1": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      "val_auroc": [
        0.6045774139308131,
        0.6214359864379314,
        0.6272030161331532,
        0.6294540818557844,
        0.6308885203488572,
        0.6311438017755906,
        0.6317973625091209,
        0.6327408751815526,
        0.6328305006134234,
        0.6326748429612818,
        0.6329181119906455,
        0.6332704276931364,
        0.6331072173360617,
        0.633292150711134,
        0.633288410323929,
        0.633678705342654,
        0.6340199437445765,
        0.6341226605316643,
        0.6336382084581088,
        0.6338474543500128
      ],
      "learning_rate": [
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001
      ]
    },
    "final_metrics": {
      "loss": 0.42860034595836294,
      "accuracy": 0.829337899543379,
      "precision": 0.0,
      "recall": 0.0,
      "f1": 0.0,
      "auroc": 0.6338474543500128
    },
    "best_val_f1": 0.0,
    "training_time": 28.72498059272766,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.1.hook_resid_pre",
    "hook_layer": 1,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.001,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples_pytorch",
    "probe_name": "ntml_binary_4T1L_500samples_layer_1",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority",
    "probe_method": "pytorch",
    "sklearn_C": 1.0,
    "sklearn_C_sweep": false,
    "sklearn_C_values": [
      0.0001,
      0.001,
      0.01,
      0.1,
      1.0,
      10.0,
      100.0,
      1000.0,
      10000.0
    ],
    "sklearn_solver": "liblinear",
    "sklearn_max_iter": 1000,
    "pytorch_bias": true,
    "pytorch_normalize_weights": true
  }
}