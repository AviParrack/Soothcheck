{
  "model_type": "pytorch_interpretability_probe",
  "training_history": {
    "train_loss": [
      0.366446557144324,
      0.308585649245678,
      0.2911089846872848,
      0.2822796910763059,
      0.27769053438210595,
      0.27458794159840233,
      0.27254866534784505,
      0.2710394949129183,
      0.2699943215131215,
      0.2690452156613951,
      0.2684045923729193,
      0.26788765028731465,
      0.26733926772118705,
      0.2673193954577729,
      0.2668350886672599,
      0.26649684623972464,
      0.26641254045375407,
      0.26614107242594026,
      0.2661873015094565,
      0.26596997404411504
    ],
    "train_accuracy": [
      0.8454513021762398,
      0.8678201926507314,
      0.8749197288619336,
      0.8790938280413843,
      0.8816625044595077,
      0.8830538708526579,
      0.8840171245094541,
      0.8840884766321798,
      0.8848019978594364,
      0.8851230824117018,
      0.8859793078844096,
      0.8860149839457724,
      0.8857652515162326,
      0.8865501248662148,
      0.8862647163753121,
      0.8859079557616839,
      0.8860863360684981,
      0.886692829111666,
      0.8868355333571174,
      0.8869425615412059
    ],
    "val_loss": [
      0.33274819634177466,
      0.30865789760242807,
      0.2994365323673595,
      0.293460936979814,
      0.2917983423579823,
      0.2897952903400768,
      0.2881472414190119,
      0.2879397305575284,
      0.2869125647978349,
      0.28597486235878683,
      0.2855591557242654,
      0.2855657108805396,
      0.28512775897979736,
      0.28494421352039684,
      0.2845490666953,
      0.28497193293137985,
      0.2844358140772039,
      0.2842036962509155,
      0.2842848826538433,
      0.28435943993655116
    ],
    "val_accuracy": [
      0.8491723744292238,
      0.8665810502283106,
      0.872574200913242,
      0.8730022831050228,
      0.8715753424657534,
      0.879851598173516,
      0.8741438356164384,
      0.8752853881278538,
      0.8769977168949772,
      0.8782819634703196,
      0.8782819634703196,
      0.8761415525114156,
      0.8785673515981736,
      0.8779965753424658,
      0.8785673515981736,
      0.8777111872146118,
      0.8794235159817352,
      0.8811358447488584,
      0.8784246575342466,
      0.877568493150685
    ],
    "val_f1": [
      0.29107981220657275,
      0.42673206621704474,
      0.46494907130017976,
      0.4696066746126341,
      0.45255474452554745,
      0.5172018348623854,
      0.4756242568370987,
      0.4797619047619048,
      0.4911452184179457,
      0.5037812681791739,
      0.5049332559489262,
      0.4851720047449585,
      0.5043680838672102,
      0.49970743124634287,
      0.505520046484602,
      0.49617871840094063,
      0.5095763203714452,
      0.5209890741805635,
      0.5017543859649123,
      0.49469964664310956
    ],
    "val_auroc": [
      0.8808120917036506,
      0.9019808275845365,
      0.909298929129268,
      0.9169928675897314,
      0.919637506686765,
      0.9214761147984116,
      0.9228987967233147,
      0.9224021351991177,
      0.9229132734045132,
      0.9242822941697811,
      0.9244894916694356,
      0.9247495151355789,
      0.9245281193524414,
      0.9250226232943441,
      0.9256621028465193,
      0.9245054299386397,
      0.9254034017695237,
      0.9255642460495712,
      0.9255360582808914,
      0.9261028064299293
    ],
    "learning_rate": [
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.10.hook_resid_pre",
      "hook_layer": 10,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.001,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples_pytorch",
      "probe_name": "ntml_binary_4T1L_500samples_layer_10",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority",
      "probe_method": "pytorch",
      "sklearn_C": 1.0,
      "sklearn_C_sweep": false,
      "sklearn_C_values": [
        0.0001,
        0.001,
        0.01,
        0.1,
        1.0,
        10.0,
        100.0,
        1000.0,
        10000.0
      ],
      "sklearn_solver": "liblinear",
      "sklearn_max_iter": 1000,
      "pytorch_bias": true,
      "pytorch_normalize_weights": true
    },
    "training_history": {
      "train_loss": [
        0.366446557144324,
        0.308585649245678,
        0.2911089846872848,
        0.2822796910763059,
        0.27769053438210595,
        0.27458794159840233,
        0.27254866534784505,
        0.2710394949129183,
        0.2699943215131215,
        0.2690452156613951,
        0.2684045923729193,
        0.26788765028731465,
        0.26733926772118705,
        0.2673193954577729,
        0.2668350886672599,
        0.26649684623972464,
        0.26641254045375407,
        0.26614107242594026,
        0.2661873015094565,
        0.26596997404411504
      ],
      "train_accuracy": [
        0.8454513021762398,
        0.8678201926507314,
        0.8749197288619336,
        0.8790938280413843,
        0.8816625044595077,
        0.8830538708526579,
        0.8840171245094541,
        0.8840884766321798,
        0.8848019978594364,
        0.8851230824117018,
        0.8859793078844096,
        0.8860149839457724,
        0.8857652515162326,
        0.8865501248662148,
        0.8862647163753121,
        0.8859079557616839,
        0.8860863360684981,
        0.886692829111666,
        0.8868355333571174,
        0.8869425615412059
      ],
      "val_loss": [
        0.33274819634177466,
        0.30865789760242807,
        0.2994365323673595,
        0.293460936979814,
        0.2917983423579823,
        0.2897952903400768,
        0.2881472414190119,
        0.2879397305575284,
        0.2869125647978349,
        0.28597486235878683,
        0.2855591557242654,
        0.2855657108805396,
        0.28512775897979736,
        0.28494421352039684,
        0.2845490666953,
        0.28497193293137985,
        0.2844358140772039,
        0.2842036962509155,
        0.2842848826538433,
        0.28435943993655116
      ],
      "val_accuracy": [
        0.8491723744292238,
        0.8665810502283106,
        0.872574200913242,
        0.8730022831050228,
        0.8715753424657534,
        0.879851598173516,
        0.8741438356164384,
        0.8752853881278538,
        0.8769977168949772,
        0.8782819634703196,
        0.8782819634703196,
        0.8761415525114156,
        0.8785673515981736,
        0.8779965753424658,
        0.8785673515981736,
        0.8777111872146118,
        0.8794235159817352,
        0.8811358447488584,
        0.8784246575342466,
        0.877568493150685
      ],
      "val_f1": [
        0.29107981220657275,
        0.42673206621704474,
        0.46494907130017976,
        0.4696066746126341,
        0.45255474452554745,
        0.5172018348623854,
        0.4756242568370987,
        0.4797619047619048,
        0.4911452184179457,
        0.5037812681791739,
        0.5049332559489262,
        0.4851720047449585,
        0.5043680838672102,
        0.49970743124634287,
        0.505520046484602,
        0.49617871840094063,
        0.5095763203714452,
        0.5209890741805635,
        0.5017543859649123,
        0.49469964664310956
      ],
      "val_auroc": [
        0.8808120917036506,
        0.9019808275845365,
        0.909298929129268,
        0.9169928675897314,
        0.919637506686765,
        0.9214761147984116,
        0.9228987967233147,
        0.9224021351991177,
        0.9229132734045132,
        0.9242822941697811,
        0.9244894916694356,
        0.9247495151355789,
        0.9245281193524414,
        0.9250226232943441,
        0.9256621028465193,
        0.9245054299386397,
        0.9254034017695237,
        0.9255642460495712,
        0.9255360582808914,
        0.9261028064299293
      ],
      "learning_rate": [
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001
      ]
    },
    "final_metrics": {
      "loss": 0.28435943993655116,
      "accuracy": 0.877568493150685,
      "precision": 0.9312638580931264,
      "recall": 0.3368083400160385,
      "f1": 0.49469964664310956,
      "auroc": 0.9261028064299293
    },
    "best_val_f1": 0.5209890741805635,
    "training_time": 28.719534158706665,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.10.hook_resid_pre",
    "hook_layer": 10,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.001,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples_pytorch",
    "probe_name": "ntml_binary_4T1L_500samples_layer_10",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority",
    "probe_method": "pytorch",
    "sklearn_C": 1.0,
    "sklearn_C_sweep": false,
    "sklearn_C_values": [
      0.0001,
      0.001,
      0.01,
      0.1,
      1.0,
      10.0,
      100.0,
      1000.0,
      10000.0
    ],
    "sklearn_solver": "liblinear",
    "sklearn_max_iter": 1000,
    "pytorch_bias": true,
    "pytorch_normalize_weights": true
  }
}