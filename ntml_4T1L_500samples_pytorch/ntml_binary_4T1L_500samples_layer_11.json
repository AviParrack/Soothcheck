{
  "model_type": "pytorch_interpretability_probe",
  "training_history": {
    "train_loss": [
      0.34543497030321324,
      0.2792156254660049,
      0.2617936874463406,
      0.2534691274982609,
      0.24870008361189877,
      0.24584571756932833,
      0.24379628267326311,
      0.24229557482211012,
      0.2411969203212762,
      0.24017584056818866,
      0.23968634114826107,
      0.239263708613915,
      0.2386432204854815,
      0.23836286712999213,
      0.23814485249317943,
      0.23780733073070714,
      0.2376076927298008,
      0.23737056847644722,
      0.23735875136231724,
      0.23701371915944636
    ],
    "train_accuracy": [
      0.8556903317873706,
      0.8828398144844809,
      0.891830181947913,
      0.8949339992864788,
      0.8973956475205137,
      0.8980378166250446,
      0.8998216196931859,
      0.9004994648590796,
      0.9013200142704245,
      0.9014983945772387,
      0.902247591865858,
      0.9021762397431323,
      0.9026043524794862,
      0.9026043524794862,
      0.9024973242953978,
      0.9029611130931146,
      0.9025330003567607,
      0.9028184088476632,
      0.9029967891544773,
      0.9027113806635747
    ],
    "val_loss": [
      0.29680600166320803,
      0.2720261313698509,
      0.26031008769165387,
      0.255468056418679,
      0.2528760801662098,
      0.2518155959519473,
      0.2505479010668668,
      0.24873988411643289,
      0.2478222066705877,
      0.24772566231814297,
      0.2470108216459101,
      0.2468509869142012,
      0.24639729044654152,
      0.246287447755987,
      0.24671166376634077,
      0.24596457481384276,
      0.2456893639131026,
      0.2453692848032171,
      0.24520217288624158,
      0.24540311152284797
    ],
    "val_accuracy": [
      0.8849885844748858,
      0.8974029680365296,
      0.8936929223744292,
      0.8951198630136986,
      0.8974029680365296,
      0.8952625570776256,
      0.9045376712328768,
      0.8999714611872146,
      0.9002568493150684,
      0.9005422374429224,
      0.901541095890411,
      0.9033961187214612,
      0.9018264840182648,
      0.9022545662100456,
      0.9072488584474886,
      0.901398401826484,
      0.9048230593607306,
      0.903824200913242,
      0.9032534246575342,
      0.9056792237442922
    ],
    "val_f1": [
      0.5185185185185185,
      0.5944726452340665,
      0.5645821157218002,
      0.570426651081239,
      0.5836711059640995,
      0.5727590221187427,
      0.6289517470881864,
      0.6010244735344337,
      0.6003430531732419,
      0.603752131893121,
      0.6079545454545454,
      0.6185915492957746,
      0.6099773242630385,
      0.6123372948500283,
      0.6404867256637168,
      0.6076093128904032,
      0.6259113853056646,
      0.6196388261851016,
      0.6165158371040724,
      0.6309324399776661
    ],
    "val_auroc": [
      0.907370077311926,
      0.9283216740432462,
      0.9359094858083922,
      0.9386216293447021,
      0.9402659023527559,
      0.9420469341909312,
      0.9433054753197098,
      0.9442640827405319,
      0.9442159292366628,
      0.9446309562969164,
      0.9447934833697664,
      0.9454223580533316,
      0.9454990869548631,
      0.9455347162290265,
      0.9455601965584282,
      0.9460851345311008,
      0.9456935724069626,
      0.9457962135078857,
      0.9461060802256089,
      0.9459642829122721
    ],
    "learning_rate": [
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.11.hook_resid_pre",
      "hook_layer": 11,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.001,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples_pytorch",
      "probe_name": "ntml_binary_4T1L_500samples_layer_11",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority",
      "probe_method": "pytorch",
      "sklearn_C": 1.0,
      "sklearn_C_sweep": false,
      "sklearn_C_values": [
        0.0001,
        0.001,
        0.01,
        0.1,
        1.0,
        10.0,
        100.0,
        1000.0,
        10000.0
      ],
      "sklearn_solver": "liblinear",
      "sklearn_max_iter": 1000,
      "pytorch_bias": true,
      "pytorch_normalize_weights": true
    },
    "training_history": {
      "train_loss": [
        0.34543497030321324,
        0.2792156254660049,
        0.2617936874463406,
        0.2534691274982609,
        0.24870008361189877,
        0.24584571756932833,
        0.24379628267326311,
        0.24229557482211012,
        0.2411969203212762,
        0.24017584056818866,
        0.23968634114826107,
        0.239263708613915,
        0.2386432204854815,
        0.23836286712999213,
        0.23814485249317943,
        0.23780733073070714,
        0.2376076927298008,
        0.23737056847644722,
        0.23735875136231724,
        0.23701371915944636
      ],
      "train_accuracy": [
        0.8556903317873706,
        0.8828398144844809,
        0.891830181947913,
        0.8949339992864788,
        0.8973956475205137,
        0.8980378166250446,
        0.8998216196931859,
        0.9004994648590796,
        0.9013200142704245,
        0.9014983945772387,
        0.902247591865858,
        0.9021762397431323,
        0.9026043524794862,
        0.9026043524794862,
        0.9024973242953978,
        0.9029611130931146,
        0.9025330003567607,
        0.9028184088476632,
        0.9029967891544773,
        0.9027113806635747
      ],
      "val_loss": [
        0.29680600166320803,
        0.2720261313698509,
        0.26031008769165387,
        0.255468056418679,
        0.2528760801662098,
        0.2518155959519473,
        0.2505479010668668,
        0.24873988411643289,
        0.2478222066705877,
        0.24772566231814297,
        0.2470108216459101,
        0.2468509869142012,
        0.24639729044654152,
        0.246287447755987,
        0.24671166376634077,
        0.24596457481384276,
        0.2456893639131026,
        0.2453692848032171,
        0.24520217288624158,
        0.24540311152284797
      ],
      "val_accuracy": [
        0.8849885844748858,
        0.8974029680365296,
        0.8936929223744292,
        0.8951198630136986,
        0.8974029680365296,
        0.8952625570776256,
        0.9045376712328768,
        0.8999714611872146,
        0.9002568493150684,
        0.9005422374429224,
        0.901541095890411,
        0.9033961187214612,
        0.9018264840182648,
        0.9022545662100456,
        0.9072488584474886,
        0.901398401826484,
        0.9048230593607306,
        0.903824200913242,
        0.9032534246575342,
        0.9056792237442922
      ],
      "val_f1": [
        0.5185185185185185,
        0.5944726452340665,
        0.5645821157218002,
        0.570426651081239,
        0.5836711059640995,
        0.5727590221187427,
        0.6289517470881864,
        0.6010244735344337,
        0.6003430531732419,
        0.603752131893121,
        0.6079545454545454,
        0.6185915492957746,
        0.6099773242630385,
        0.6123372948500283,
        0.6404867256637168,
        0.6076093128904032,
        0.6259113853056646,
        0.6196388261851016,
        0.6165158371040724,
        0.6309324399776661
      ],
      "val_auroc": [
        0.907370077311926,
        0.9283216740432462,
        0.9359094858083922,
        0.9386216293447021,
        0.9402659023527559,
        0.9420469341909312,
        0.9433054753197098,
        0.9442640827405319,
        0.9442159292366628,
        0.9446309562969164,
        0.9447934833697664,
        0.9454223580533316,
        0.9454990869548631,
        0.9455347162290265,
        0.9455601965584282,
        0.9460851345311008,
        0.9456935724069626,
        0.9457962135078857,
        0.9461060802256089,
        0.9459642829122721
      ],
      "learning_rate": [
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001
      ]
    },
    "final_metrics": {
      "loss": 0.24540311152284797,
      "accuracy": 0.9056792237442922,
      "precision": 0.947986577181208,
      "recall": 0.47280334728033474,
      "f1": 0.6309324399776661,
      "auroc": 0.9459642829122721
    },
    "best_val_f1": 0.6404867256637168,
    "training_time": 28.113513469696045,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.11.hook_resid_pre",
    "hook_layer": 11,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.001,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples_pytorch",
    "probe_name": "ntml_binary_4T1L_500samples_layer_11",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority",
    "probe_method": "pytorch",
    "sklearn_C": 1.0,
    "sklearn_C_sweep": false,
    "sklearn_C_values": [
      0.0001,
      0.001,
      0.01,
      0.1,
      1.0,
      10.0,
      100.0,
      1000.0,
      10000.0
    ],
    "sklearn_solver": "liblinear",
    "sklearn_max_iter": 1000,
    "pytorch_bias": true,
    "pytorch_normalize_weights": true
  }
}