{
  "model_type": "pytorch_interpretability_probe",
  "training_history": {
    "train_loss": [
      0.42534900555327604,
      0.40309897837437453,
      0.39400832671416947,
      0.3890107310117652,
      0.38597626147204883,
      0.3837891990599567,
      0.38229216955023815,
      0.38113947590328245,
      0.38039395039620466,
      0.3799699810269761,
      0.37916911992172125,
      0.37897368350393695,
      0.37855414080021044,
      0.3782135260091525,
      0.378054228649564,
      0.37784474445124194,
      0.37758806820737717,
      0.3774669411928142,
      0.37726407487914987,
      0.37713786901812574
    ],
    "train_accuracy": [
      0.829646806992508,
      0.8300749197288619,
      0.8312165536924724,
      0.8320371031038173,
      0.8330003567606137,
      0.8329646806992508,
      0.8336782019265073,
      0.8338565822333215,
      0.8338922582946843,
      0.8342490189083125,
      0.8339992864787728,
      0.8347484837673921,
      0.8345701034605779,
      0.8346057795219408,
      0.8344987513378523,
      0.8348555119514806,
      0.8347841598287549,
      0.8346057795219408,
      0.8346771316446664,
      0.8348198358901178
    ],
    "val_loss": [
      0.42563211701133036,
      0.41863997199318626,
      0.41450412923639474,
      0.41272407445040615,
      0.4111416534944014,
      0.4108049696142023,
      0.409759842265736,
      0.40966408902948553,
      0.4092630299654874,
      0.409116285497492,
      0.4088927919214422,
      0.4087207924235951,
      0.4085747171532024,
      0.4086059440266002,
      0.40812660347331653,
      0.40786024846813895,
      0.4083503072912043,
      0.4084813421422785,
      0.40773152004588736,
      0.4083135474811901
    ],
    "val_accuracy": [
      0.8217751141552512,
      0.8224885844748858,
      0.8242009132420092,
      0.8242009132420092,
      0.8242009132420092,
      0.8249143835616438,
      0.8249143835616438,
      0.824343607305936,
      0.8247716894977168,
      0.8250570776255708,
      0.8253424657534246,
      0.8249143835616438,
      0.8253424657534246,
      0.8256278538812786,
      0.8253424657534246,
      0.8253424657534246,
      0.8253424657534246,
      0.8250570776255708,
      0.8257705479452054,
      0.8251997716894978
    ],
    "val_f1": [
      0.0,
      0.014263074484944533,
      0.0375,
      0.0390015600624025,
      0.0375,
      0.049573973663826494,
      0.04809930178432894,
      0.03752931978107897,
      0.04510108864696734,
      0.04665629860031104,
      0.05263157894736842,
      0.045136186770428015,
      0.049689440993788817,
      0.05564142194744977,
      0.049689440993788817,
      0.049689440993788817,
      0.05263157894736842,
      0.045171339563862926,
      0.054221533694810226,
      0.048174048174048176
    ],
    "val_auroc": [
      0.6973717192194457,
      0.7115708889389685,
      0.7219535656307647,
      0.7291021912859338,
      0.7329927842256441,
      0.733278270471908,
      0.7355044653885984,
      0.7366693493707972,
      0.7359741587331333,
      0.7360199672153073,
      0.7348527198212815,
      0.7378076102138874,
      0.737759229783549,
      0.7379127820401832,
      0.7391061659885296,
      0.739785646888756,
      0.7363992948135206,
      0.7389356527764319,
      0.7395839227381211,
      0.7382579096790194
    ],
    "learning_rate": [
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.6.hook_resid_pre",
      "hook_layer": 6,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.001,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples_pytorch",
      "probe_name": "ntml_binary_4T1L_500samples_layer_6",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority",
      "probe_method": "pytorch",
      "sklearn_C": 1.0,
      "sklearn_C_sweep": false,
      "sklearn_C_values": [
        0.0001,
        0.001,
        0.01,
        0.1,
        1.0,
        10.0,
        100.0,
        1000.0,
        10000.0
      ],
      "sklearn_solver": "liblinear",
      "sklearn_max_iter": 1000,
      "pytorch_bias": true,
      "pytorch_normalize_weights": true
    },
    "training_history": {
      "train_loss": [
        0.42534900555327604,
        0.40309897837437453,
        0.39400832671416947,
        0.3890107310117652,
        0.38597626147204883,
        0.3837891990599567,
        0.38229216955023815,
        0.38113947590328245,
        0.38039395039620466,
        0.3799699810269761,
        0.37916911992172125,
        0.37897368350393695,
        0.37855414080021044,
        0.3782135260091525,
        0.378054228649564,
        0.37784474445124194,
        0.37758806820737717,
        0.3774669411928142,
        0.37726407487914987,
        0.37713786901812574
      ],
      "train_accuracy": [
        0.829646806992508,
        0.8300749197288619,
        0.8312165536924724,
        0.8320371031038173,
        0.8330003567606137,
        0.8329646806992508,
        0.8336782019265073,
        0.8338565822333215,
        0.8338922582946843,
        0.8342490189083125,
        0.8339992864787728,
        0.8347484837673921,
        0.8345701034605779,
        0.8346057795219408,
        0.8344987513378523,
        0.8348555119514806,
        0.8347841598287549,
        0.8346057795219408,
        0.8346771316446664,
        0.8348198358901178
      ],
      "val_loss": [
        0.42563211701133036,
        0.41863997199318626,
        0.41450412923639474,
        0.41272407445040615,
        0.4111416534944014,
        0.4108049696142023,
        0.409759842265736,
        0.40966408902948553,
        0.4092630299654874,
        0.409116285497492,
        0.4088927919214422,
        0.4087207924235951,
        0.4085747171532024,
        0.4086059440266002,
        0.40812660347331653,
        0.40786024846813895,
        0.4083503072912043,
        0.4084813421422785,
        0.40773152004588736,
        0.4083135474811901
      ],
      "val_accuracy": [
        0.8217751141552512,
        0.8224885844748858,
        0.8242009132420092,
        0.8242009132420092,
        0.8242009132420092,
        0.8249143835616438,
        0.8249143835616438,
        0.824343607305936,
        0.8247716894977168,
        0.8250570776255708,
        0.8253424657534246,
        0.8249143835616438,
        0.8253424657534246,
        0.8256278538812786,
        0.8253424657534246,
        0.8253424657534246,
        0.8253424657534246,
        0.8250570776255708,
        0.8257705479452054,
        0.8251997716894978
      ],
      "val_f1": [
        0.0,
        0.014263074484944533,
        0.0375,
        0.0390015600624025,
        0.0375,
        0.049573973663826494,
        0.04809930178432894,
        0.03752931978107897,
        0.04510108864696734,
        0.04665629860031104,
        0.05263157894736842,
        0.045136186770428015,
        0.049689440993788817,
        0.05564142194744977,
        0.049689440993788817,
        0.049689440993788817,
        0.05263157894736842,
        0.045171339563862926,
        0.054221533694810226,
        0.048174048174048176
      ],
      "val_auroc": [
        0.6973717192194457,
        0.7115708889389685,
        0.7219535656307647,
        0.7291021912859338,
        0.7329927842256441,
        0.733278270471908,
        0.7355044653885984,
        0.7366693493707972,
        0.7359741587331333,
        0.7360199672153073,
        0.7348527198212815,
        0.7378076102138874,
        0.737759229783549,
        0.7379127820401832,
        0.7391061659885296,
        0.739785646888756,
        0.7363992948135206,
        0.7389356527764319,
        0.7395839227381211,
        0.7382579096790194
      ],
      "learning_rate": [
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001
      ]
    },
    "final_metrics": {
      "loss": 0.4083135474811901,
      "accuracy": 0.8251997716894978,
      "precision": 0.8157894736842105,
      "recall": 0.024819855884707767,
      "f1": 0.048174048174048176,
      "auroc": 0.7382579096790194
    },
    "best_val_f1": 0.05564142194744977,
    "training_time": 28.533700227737427,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.6.hook_resid_pre",
    "hook_layer": 6,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.001,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples_pytorch",
    "probe_name": "ntml_binary_4T1L_500samples_layer_6",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority",
    "probe_method": "pytorch",
    "sklearn_C": 1.0,
    "sklearn_C_sweep": false,
    "sklearn_C_values": [
      0.0001,
      0.001,
      0.01,
      0.1,
      1.0,
      10.0,
      100.0,
      1000.0,
      10000.0
    ],
    "sklearn_solver": "liblinear",
    "sklearn_max_iter": 1000,
    "pytorch_bias": true,
    "pytorch_normalize_weights": true
  }
}