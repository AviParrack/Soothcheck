{
  "model_type": "pytorch_interpretability_probe",
  "training_history": {
    "train_loss": [
      0.4075239199685724,
      0.3692365425158309,
      0.354398052203873,
      0.3472132422540286,
      0.34300204989028305,
      0.34005593416625507,
      0.33792115232511744,
      0.3365327386211043,
      0.33534273442272183,
      0.3344375444873827,
      0.3338481614442721,
      0.333296483544182,
      0.3327908409784918,
      0.33243637790554736,
      0.3321182009632185,
      0.33176789640291643,
      0.33155008864729374,
      0.3312958768105398,
      0.33110974198334836,
      0.33106293636437967
    ],
    "train_accuracy": [
      0.8301819479129504,
      0.8389582590082055,
      0.8435247948626472,
      0.8461291473421334,
      0.8485194434534428,
      0.8494113449875134,
      0.8506600071352123,
      0.8504816268283981,
      0.8506600071352123,
      0.8512308241170174,
      0.8510167677488405,
      0.8513021762397431,
      0.8513378523011059,
      0.8514448804851944,
      0.8511594719942919,
      0.8518373171601855,
      0.8521227256510882,
      0.8516946129147343,
      0.8518016410988227,
      0.8519086692829112
    ],
    "val_loss": [
      0.38273583325472743,
      0.365194728157737,
      0.3587394725192677,
      0.35566453554413535,
      0.35268865390257403,
      0.3518495277924971,
      0.3500461935997009,
      0.3495774204080755,
      0.3484111070632935,
      0.3485432213002985,
      0.34765866778113624,
      0.34715732498602436,
      0.3469831423325972,
      0.347261381149292,
      0.346562519940463,
      0.34640157439491964,
      0.34646353288130327,
      0.3461161437359723,
      0.3460278397256678,
      0.3460386438803239
    ],
    "val_accuracy": [
      0.836329908675799,
      0.841181506849315,
      0.8456050228310502,
      0.8480308219178082,
      0.846175799086758,
      0.8477454337899544,
      0.848601598173516,
      0.8500285388127854,
      0.8477454337899544,
      0.850884703196347,
      0.8470319634703196,
      0.848458904109589,
      0.8496004566210046,
      0.8456050228310502,
      0.848744292237443,
      0.848458904109589,
      0.8477454337899544,
      0.8480308219178082,
      0.848458904109589,
      0.848601598173516
    ],
    "val_f1": [
      0.0932806324110672,
      0.14843152257077277,
      0.20206489675516223,
      0.22657952069716775,
      0.20029673590504452,
      0.21831501831501832,
      0.22723962126729788,
      0.24442846872753415,
      0.21716801173881145,
      0.2572850035536603,
      0.20943952802359883,
      0.22481751824817517,
      0.2384393063583815,
      0.19732937685459942,
      0.23076923076923078,
      0.2236842105263158,
      0.21831501831501832,
      0.21978021978021978,
      0.2236842105263158,
      0.22498173849525202
    ],
    "val_auroc": [
      0.7836973427456382,
      0.8181927226813591,
      0.8282900022956841,
      0.8348098886593205,
      0.8399718061294766,
      0.8412203713269054,
      0.8456116563360881,
      0.8458303202479338,
      0.8474691517447199,
      0.8489789944903582,
      0.8492942206152434,
      0.8507065685261709,
      0.850774075987144,
      0.8511019283746556,
      0.8515193841827364,
      0.8524495666896235,
      0.8516952192378329,
      0.852495767332415,
      0.8526756198347107,
      0.8519069243572085
    ],
    "learning_rate": [
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001,
      0.001
    ]
  },
  "metadata": {
    "dataset_info": {
      "total_assistant_tokens": 35038,
      "truth_tokens": 29014,
      "lie_tokens": 6024,
      "truth_ratio": 0.8280723785604202,
      "lie_ratio": 0.17192762143957988
    },
    "num_examples": 500,
    "num_assistant_tokens": 35038,
    "hidden_size": 4096,
    "config": {
      "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
      "max_length": 512,
      "model_name": "meta-llama/Llama-3.1-8B-Instruct",
      "hook_point": "blocks.8.hook_resid_pre",
      "hook_layer": 8,
      "device": "cuda",
      "dtype": "bfloat16",
      "batch_size": 32,
      "learning_rate": 0.001,
      "num_epochs": 20,
      "weight_decay": 0.001,
      "train_ratio": 0.8,
      "handle_class_imbalance": true,
      "optimizer_type": "AdamW",
      "scheduler_type": "cosine",
      "warmup_ratio": 0.1,
      "gradient_clip_norm": 1.0,
      "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
      "activation_batch_size": 16,
      "force_recache": false,
      "output_dir": "./ntml_4T1L_500samples_pytorch",
      "probe_name": "ntml_binary_4T1L_500samples_layer_8",
      "save_checkpoints": true,
      "checkpoint_every": 5,
      "verbose": true,
      "log_every": 10,
      "eval_every": 1,
      "ignore_system_tokens": true,
      "ignore_user_tokens": true,
      "min_tokens_per_statement": 1,
      "token_overlap_strategy": "majority",
      "probe_method": "pytorch",
      "sklearn_C": 1.0,
      "sklearn_C_sweep": false,
      "sklearn_C_values": [
        0.0001,
        0.001,
        0.01,
        0.1,
        1.0,
        10.0,
        100.0,
        1000.0,
        10000.0
      ],
      "sklearn_solver": "liblinear",
      "sklearn_max_iter": 1000,
      "pytorch_bias": true,
      "pytorch_normalize_weights": true
    },
    "training_history": {
      "train_loss": [
        0.4075239199685724,
        0.3692365425158309,
        0.354398052203873,
        0.3472132422540286,
        0.34300204989028305,
        0.34005593416625507,
        0.33792115232511744,
        0.3365327386211043,
        0.33534273442272183,
        0.3344375444873827,
        0.3338481614442721,
        0.333296483544182,
        0.3327908409784918,
        0.33243637790554736,
        0.3321182009632185,
        0.33176789640291643,
        0.33155008864729374,
        0.3312958768105398,
        0.33110974198334836,
        0.33106293636437967
      ],
      "train_accuracy": [
        0.8301819479129504,
        0.8389582590082055,
        0.8435247948626472,
        0.8461291473421334,
        0.8485194434534428,
        0.8494113449875134,
        0.8506600071352123,
        0.8504816268283981,
        0.8506600071352123,
        0.8512308241170174,
        0.8510167677488405,
        0.8513021762397431,
        0.8513378523011059,
        0.8514448804851944,
        0.8511594719942919,
        0.8518373171601855,
        0.8521227256510882,
        0.8516946129147343,
        0.8518016410988227,
        0.8519086692829112
      ],
      "val_loss": [
        0.38273583325472743,
        0.365194728157737,
        0.3587394725192677,
        0.35566453554413535,
        0.35268865390257403,
        0.3518495277924971,
        0.3500461935997009,
        0.3495774204080755,
        0.3484111070632935,
        0.3485432213002985,
        0.34765866778113624,
        0.34715732498602436,
        0.3469831423325972,
        0.347261381149292,
        0.346562519940463,
        0.34640157439491964,
        0.34646353288130327,
        0.3461161437359723,
        0.3460278397256678,
        0.3460386438803239
      ],
      "val_accuracy": [
        0.836329908675799,
        0.841181506849315,
        0.8456050228310502,
        0.8480308219178082,
        0.846175799086758,
        0.8477454337899544,
        0.848601598173516,
        0.8500285388127854,
        0.8477454337899544,
        0.850884703196347,
        0.8470319634703196,
        0.848458904109589,
        0.8496004566210046,
        0.8456050228310502,
        0.848744292237443,
        0.848458904109589,
        0.8477454337899544,
        0.8480308219178082,
        0.848458904109589,
        0.848601598173516
      ],
      "val_f1": [
        0.0932806324110672,
        0.14843152257077277,
        0.20206489675516223,
        0.22657952069716775,
        0.20029673590504452,
        0.21831501831501832,
        0.22723962126729788,
        0.24442846872753415,
        0.21716801173881145,
        0.2572850035536603,
        0.20943952802359883,
        0.22481751824817517,
        0.2384393063583815,
        0.19732937685459942,
        0.23076923076923078,
        0.2236842105263158,
        0.21831501831501832,
        0.21978021978021978,
        0.2236842105263158,
        0.22498173849525202
      ],
      "val_auroc": [
        0.7836973427456382,
        0.8181927226813591,
        0.8282900022956841,
        0.8348098886593205,
        0.8399718061294766,
        0.8412203713269054,
        0.8456116563360881,
        0.8458303202479338,
        0.8474691517447199,
        0.8489789944903582,
        0.8492942206152434,
        0.8507065685261709,
        0.850774075987144,
        0.8511019283746556,
        0.8515193841827364,
        0.8524495666896235,
        0.8516952192378329,
        0.852495767332415,
        0.8526756198347107,
        0.8519069243572085
      ],
      "learning_rate": [
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001,
        0.001
      ]
    },
    "final_metrics": {
      "loss": 0.3460386438803239,
      "accuracy": 0.848601598173516,
      "precision": 0.9112426035502958,
      "recall": 0.12833333333333333,
      "f1": 0.22498173849525202,
      "auroc": 0.8519069243572085
    },
    "best_val_f1": 0.2572850035536603,
    "training_time": 29.021850109100342,
    "num_parameters": 4097
  },
  "config": {
    "dataset_path": "data/NTML-datasets/4T1L_500samples.jsonl",
    "max_length": 512,
    "model_name": "meta-llama/Llama-3.1-8B-Instruct",
    "hook_point": "blocks.8.hook_resid_pre",
    "hook_layer": 8,
    "device": "cuda",
    "dtype": "bfloat16",
    "batch_size": 32,
    "learning_rate": 0.001,
    "num_epochs": 20,
    "weight_decay": 0.001,
    "train_ratio": 0.8,
    "handle_class_imbalance": true,
    "optimizer_type": "AdamW",
    "scheduler_type": "cosine",
    "warmup_ratio": 0.1,
    "gradient_clip_norm": 1.0,
    "cache_dir": "./cache/ntml_binary/meta_llama_Llama_3.1_8B_Instruct_4T1L_500samples",
    "activation_batch_size": 16,
    "force_recache": false,
    "output_dir": "./ntml_4T1L_500samples_pytorch",
    "probe_name": "ntml_binary_4T1L_500samples_layer_8",
    "save_checkpoints": true,
    "checkpoint_every": 5,
    "verbose": true,
    "log_every": 10,
    "eval_every": 1,
    "ignore_system_tokens": true,
    "ignore_user_tokens": true,
    "min_tokens_per_statement": 1,
    "token_overlap_strategy": "majority",
    "probe_method": "pytorch",
    "sklearn_C": 1.0,
    "sklearn_C_sweep": false,
    "sklearn_C_values": [
      0.0001,
      0.001,
      0.01,
      0.1,
      1.0,
      10.0,
      100.0,
      1000.0,
      10000.0
    ],
    "sklearn_solver": "liblinear",
    "sklearn_max_iter": 1000,
    "pytorch_bias": true,
    "pytorch_normalize_weights": true
  }
}